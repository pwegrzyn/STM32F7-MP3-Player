ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 1


   1              		.cpu cortex-m7
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"mp3_player.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.BSP_init,"ax",%progbits
  18              		.align	1
  19              		.global	BSP_init
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  23              		.fpu fpv5-sp-d16
  25              	BSP_init:
  26              	.LFB144:
  27              		.file 1 "Src/mp3_player.c"
   1:Src/mp3_player.c **** /*
   2:Src/mp3_player.c ****  *	Main MP3 Player functionality
   3:Src/mp3_player.c ****  */
   4:Src/mp3_player.c **** 
   5:Src/mp3_player.c **** #include <stdio.h>
   6:Src/mp3_player.c **** #include <string.h>
   7:Src/mp3_player.c **** #include <stdlib.h>
   8:Src/mp3_player.c **** 
   9:Src/mp3_player.c **** #include "mp3_player.h"
  10:Src/mp3_player.c **** #include "gui.h"
  11:Src/mp3_player.c **** #include "lib\helix\pub\mp3dec.h"
  12:Src/mp3_player.c **** #include "fatfs.h"
  13:Src/mp3_player.c **** #include "stm32746g_discovery_audio.h"
  14:Src/mp3_player.c **** #include "term_io.h"
  15:Src/mp3_player.c **** #include "dbgu.h"
  16:Src/mp3_player.c **** #include "ansi.h"
  17:Src/mp3_player.c **** 
  18:Src/mp3_player.c **** #define DEBUG_ON 1
  19:Src/mp3_player.c **** 
  20:Src/mp3_player.c **** // Data read from the USB and fed to the MP3 Decoder
  21:Src/mp3_player.c **** #define READ_BUFFER_SIZE 2 * MAINBUF_SIZE// + 216
  22:Src/mp3_player.c **** 
  23:Src/mp3_player.c **** // Decoded data ready to be passed out to output
  24:Src/mp3_player.c **** #define DECODED_MP3_FRAME_SIZE MAX_NGRAN * MAX_NCHAN * MAX_NSAMP
  25:Src/mp3_player.c **** #define AUDIO_OUT_BUFFER_SIZE 2 * DECODED_MP3_FRAME_SIZE
  26:Src/mp3_player.c **** 
  27:Src/mp3_player.c **** // State of the offset of the BSP output buffer
  28:Src/mp3_player.c **** typedef enum BSP_BUFFER_STATE_TAG {
  29:Src/mp3_player.c ****     BUFFER_OFFSET_NONE = 0,
  30:Src/mp3_player.c ****     BUFFER_OFFSET_HALF,
  31:Src/mp3_player.c ****     BUFFER_OFFSET_FULL,
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 2


  32:Src/mp3_player.c **** } BSP_BUFFER_STATE;
  33:Src/mp3_player.c **** 
  34:Src/mp3_player.c **** /* ------------------------------------------------------------------- */
  35:Src/mp3_player.c **** 
  36:Src/mp3_player.c **** static HMP3Decoder hMP3Decoder;
  37:Src/mp3_player.c **** Mp3_Player_State state;
  38:Src/mp3_player.c **** short output_buffer[AUDIO_OUT_BUFFER_SIZE];
  39:Src/mp3_player.c **** uint8_t input_buffer[READ_BUFFER_SIZE];
  40:Src/mp3_player.c **** static uint8_t *current_ptr;
  41:Src/mp3_player.c **** static BSP_BUFFER_STATE out_buf_offs = BUFFER_OFFSET_NONE;
  42:Src/mp3_player.c **** FIL input_file;
  43:Src/mp3_player.c **** char** paths;
  44:Src/mp3_player.c **** int mp3FilesCounter = 0;
  45:Src/mp3_player.c **** int currentFilePosition = -1;
  46:Src/mp3_player.c **** int currentFileBytes = 0;
  47:Src/mp3_player.c **** int currentFileBytesRead = 0;
  48:Src/mp3_player.c **** static int buffer_leftover = 0;
  49:Src/mp3_player.c **** static int in_buf_offs;
  50:Src/mp3_player.c **** static int decode_result;
  51:Src/mp3_player.c **** int has_been_paused = 0;
  52:Src/mp3_player.c **** char gui_info_text[100];
  53:Src/mp3_player.c **** 
  54:Src/mp3_player.c **** 
  55:Src/mp3_player.c **** /* ------------------------------------------------------------------- */
  56:Src/mp3_player.c **** void BSP_init(void);
  57:Src/mp3_player.c **** void mp3_player_init(void);
  58:Src/mp3_player.c **** void mp3_player_fsm(const char*);
  59:Src/mp3_player.c **** void mp3_player_play();
  60:Src/mp3_player.c **** int mp3_player_process_frame();
  61:Src/mp3_player.c **** int fill_input_buffer();
  62:Src/mp3_player.c **** void copy_leftover();
  63:Src/mp3_player.c **** void reset_player_state();
  64:Src/mp3_player.c **** 
  65:Src/mp3_player.c **** /* ------------------------------------------------------------------- */
  66:Src/mp3_player.c **** 
  67:Src/mp3_player.c **** // Main Finite State Machine of the player
  68:Src/mp3_player.c **** void mp3_player_fsm(const char* path)
  69:Src/mp3_player.c **** {
  70:Src/mp3_player.c ****     BSP_init();
  71:Src/mp3_player.c ****     state = NEXT;
  72:Src/mp3_player.c **** 
  73:Src/mp3_player.c ****     touchscreen_loop_init();
  74:Src/mp3_player.c **** 
  75:Src/mp3_player.c **** 	sprintf(gui_info_text, "Initializing...");
  76:Src/mp3_player.c **** 	refresh_screen(gui_info_text);
  77:Src/mp3_player.c **** 
  78:Src/mp3_player.c ****     DIR directory;
  79:Src/mp3_player.c ****     FILINFO info;
  80:Src/mp3_player.c **** 
  81:Src/mp3_player.c ****     if (f_opendir(&directory, path) != FR_OK) {
  82:Src/mp3_player.c ****         if (DEBUG_ON) xprintf("Error opening the directory\n");
  83:Src/mp3_player.c ****         return;
  84:Src/mp3_player.c ****     }
  85:Src/mp3_player.c **** 
  86:Src/mp3_player.c ****     while(1) {
  87:Src/mp3_player.c ****         if (f_readdir(&directory, &info) != FR_OK) {
  88:Src/mp3_player.c ****             xprintf("Error reading from directory\n");
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 3


  89:Src/mp3_player.c ****             return;
  90:Src/mp3_player.c ****         }
  91:Src/mp3_player.c ****         if (info.fname[0] == 0)
  92:Src/mp3_player.c ****             break;
  93:Src/mp3_player.c ****         if (strstr(info.fname, ".mp3"))
  94:Src/mp3_player.c ****             mp3FilesCounter++;
  95:Src/mp3_player.c ****     }
  96:Src/mp3_player.c **** 
  97:Src/mp3_player.c ****     f_closedir(&directory);
  98:Src/mp3_player.c **** 
  99:Src/mp3_player.c ****     int i = 0;
 100:Src/mp3_player.c ****     paths = malloc(sizeof(char*) * mp3FilesCounter);
 101:Src/mp3_player.c **** 
 102:Src/mp3_player.c ****     if (paths == NULL) {
 103:Src/mp3_player.c ****         if (DEBUG_ON) xprintf("Error allocating memory\n");
 104:Src/mp3_player.c ****         return;
 105:Src/mp3_player.c ****     }
 106:Src/mp3_player.c **** 
 107:Src/mp3_player.c ****     if (f_opendir(&directory, path) != FR_OK) {
 108:Src/mp3_player.c ****         if (DEBUG_ON) xprintf("Error opening the directory\n");
 109:Src/mp3_player.c ****         return;
 110:Src/mp3_player.c ****     }
 111:Src/mp3_player.c **** 
 112:Src/mp3_player.c ****     while(1) {
 113:Src/mp3_player.c ****         if (f_readdir(&directory, &info) != FR_OK) {
 114:Src/mp3_player.c ****             xprintf("Error reading from directory\n");
 115:Src/mp3_player.c ****             return;
 116:Src/mp3_player.c ****         }
 117:Src/mp3_player.c ****         if (info.fname[0] == 0)
 118:Src/mp3_player.c ****             break;
 119:Src/mp3_player.c ****         if (strstr(info.fname, ".mp3")) {
 120:Src/mp3_player.c ****             paths[i] = malloc((strlen(info.fname) + 1) * sizeof(char));
 121:Src/mp3_player.c **** 			strcpy(paths[i], info.fname);
 122:Src/mp3_player.c **** 			if(DEBUG_ON) xprintf("%s\n", paths[i]);
 123:Src/mp3_player.c ****             i++;
 124:Src/mp3_player.c ****         }
 125:Src/mp3_player.c ****     }
 126:Src/mp3_player.c **** 
 127:Src/mp3_player.c **** 	f_closedir(&directory);
 128:Src/mp3_player.c **** 
 129:Src/mp3_player.c **** 	while(1)
 130:Src/mp3_player.c **** 	{	
 131:Src/mp3_player.c **** 		switch(state)
 132:Src/mp3_player.c **** 		{
 133:Src/mp3_player.c **** 			case PLAY:
 134:Src/mp3_player.c **** 			    if(DEBUG_ON) xprintf("Now playing\n");
 135:Src/mp3_player.c **** 				if (f_findfirst(&directory, &info, path, paths[currentFilePosition]) != FR_OK) {
 136:Src/mp3_player.c ****             		xprintf("Error looking for first file occurence\n");
 137:Src/mp3_player.c ****             		return;
 138:Src/mp3_player.c ****         		}
 139:Src/mp3_player.c **** 				currentFileBytes = info.fsize;
 140:Src/mp3_player.c **** 				f_closedir(&directory);
 141:Src/mp3_player.c **** 				sprintf(gui_info_text, "%s", paths[currentFilePosition]);
 142:Src/mp3_player.c **** 				refresh_screen(gui_info_text);
 143:Src/mp3_player.c **** 				mp3_player_play();
 144:Src/mp3_player.c ****                 f_close(&input_file);
 145:Src/mp3_player.c **** 				currentFileBytesRead = 0;
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 4


 146:Src/mp3_player.c **** 				break;
 147:Src/mp3_player.c **** 			case NEXT:
 148:Src/mp3_player.c **** 			    reset_player_state();
 149:Src/mp3_player.c **** 			    if (currentFilePosition == mp3FilesCounter - 1)
 150:Src/mp3_player.c ****                     currentFilePosition = 0;
 151:Src/mp3_player.c ****                 else
 152:Src/mp3_player.c ****                     currentFilePosition++;
 153:Src/mp3_player.c ****                 if (f_open(&input_file, paths[currentFilePosition], FA_READ) != FR_OK) {
 154:Src/mp3_player.c ****                     if(DEBUG_ON) xprintf("Error opening file\n");
 155:Src/mp3_player.c ****                     return;
 156:Src/mp3_player.c ****                 }
 157:Src/mp3_player.c ****                 state = PLAY;
 158:Src/mp3_player.c **** 				break;
 159:Src/mp3_player.c ****             case PREV:
 160:Src/mp3_player.c ****                 reset_player_state();
 161:Src/mp3_player.c ****                 if (currentFilePosition == 0)
 162:Src/mp3_player.c ****                     currentFilePosition = mp3FilesCounter - 1;
 163:Src/mp3_player.c ****                 else
 164:Src/mp3_player.c ****                     currentFilePosition--;
 165:Src/mp3_player.c ****                 if (f_open(&input_file, paths[currentFilePosition], FA_READ) != FR_OK) {
 166:Src/mp3_player.c ****                     if(DEBUG_ON) xprintf("Error opening file\n");
 167:Src/mp3_player.c ****                     return;
 168:Src/mp3_player.c ****                 }
 169:Src/mp3_player.c ****                 state = PLAY;
 170:Src/mp3_player.c ****                 break;
 171:Src/mp3_player.c ****             case PAUSE:
 172:Src/mp3_player.c **** 				// shouldn't ever come to this place
 173:Src/mp3_player.c ****                 break;
 174:Src/mp3_player.c ****             case STOP:
 175:Src/mp3_player.c ****                 reset_player_state();
 176:Src/mp3_player.c ****                 currentFilePosition = 0;
 177:Src/mp3_player.c **** 				sprintf(gui_info_text, "STOPPED");
 178:Src/mp3_player.c **** 				refresh_screen(gui_info_text);
 179:Src/mp3_player.c ****                 while(state == STOP) {
 180:Src/mp3_player.c ****                     Mp3_Player_State newState = check_touchscreen();
 181:Src/mp3_player.c ****                     if (newState != EMPTY)
 182:Src/mp3_player.c ****                         state = newState;
 183:Src/mp3_player.c ****                 }
 184:Src/mp3_player.c ****                 if (state == PLAY)
 185:Src/mp3_player.c ****                     if (f_open(&input_file, paths[currentFilePosition], FA_READ) != FR_OK) {
 186:Src/mp3_player.c ****                         if(DEBUG_ON) xprintf("Error opening file\n");
 187:Src/mp3_player.c ****                         return;
 188:Src/mp3_player.c ****                     }
 189:Src/mp3_player.c ****                 break;
 190:Src/mp3_player.c **** 			case FINISH:
 191:Src/mp3_player.c **** 			    if(DEBUG_ON) xprintf("fsm: state -> finish\n");
 192:Src/mp3_player.c **** 				return;
 193:Src/mp3_player.c ****             default:
 194:Src/mp3_player.c ****                 if(DEBUG_ON) xprintf("fsm: state -> default\n");
 195:Src/mp3_player.c ****                 return;
 196:Src/mp3_player.c **** 		}
 197:Src/mp3_player.c **** 
 198:Src/mp3_player.c **** 	}
 199:Src/mp3_player.c **** 
 200:Src/mp3_player.c **** }
 201:Src/mp3_player.c **** 
 202:Src/mp3_player.c **** // Initialize AUDIO_OUT
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 5


 203:Src/mp3_player.c **** void BSP_init(void) {
  28              		.loc 1 203 0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 0
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32 0000 08B5     		push	{r3, lr}
  33              	.LCFI0:
  34              		.cfi_def_cfa_offset 8
  35              		.cfi_offset 3, -8
  36              		.cfi_offset 14, -4
 204:Src/mp3_player.c **** 	if(BSP_AUDIO_OUT_Init(OUTPUT_DEVICE_BOTH, 100, AUDIO_FREQUENCY_44K) == 0)
  37              		.loc 1 204 0
  38 0002 4AF64442 		movw	r2, #44100
  39 0006 6421     		movs	r1, #100
  40 0008 0320     		movs	r0, #3
  41 000a FFF7FEFF 		bl	BSP_AUDIO_OUT_Init
  42              	.LVL0:
  43 000e 18B1     		cbz	r0, .L5
 205:Src/mp3_player.c **** 	{
 206:Src/mp3_player.c **** 	  BSP_AUDIO_OUT_SetAudioFrameSlot(CODEC_AUDIOFRAME_SLOT_02);
 207:Src/mp3_player.c **** 		xprintf("Audio Init Ok\n");
 208:Src/mp3_player.c **** 	}
 209:Src/mp3_player.c **** 	else
 210:Src/mp3_player.c **** 	{
 211:Src/mp3_player.c **** 		xprintf("Audio Init Error\n");
  44              		.loc 1 211 0
  45 0010 0548     		ldr	r0, .L6
  46 0012 FFF7FEFF 		bl	xprintf
  47              	.LVL1:
  48              	.L1:
 212:Src/mp3_player.c **** 	}
 213:Src/mp3_player.c **** }
  49              		.loc 1 213 0
  50 0016 08BD     		pop	{r3, pc}
  51              	.L5:
 206:Src/mp3_player.c **** 		xprintf("Audio Init Ok\n");
  52              		.loc 1 206 0
  53 0018 0520     		movs	r0, #5
  54 001a FFF7FEFF 		bl	BSP_AUDIO_OUT_SetAudioFrameSlot
  55              	.LVL2:
 207:Src/mp3_player.c **** 	}
  56              		.loc 1 207 0
  57 001e 0348     		ldr	r0, .L6+4
  58 0020 FFF7FEFF 		bl	xprintf
  59              	.LVL3:
  60 0024 F7E7     		b	.L1
  61              	.L7:
  62 0026 00BF     		.align	2
  63              	.L6:
  64 0028 10000000 		.word	.LC1
  65 002c 00000000 		.word	.LC0
  66              		.cfi_endproc
  67              	.LFE144:
  69              		.section	.text.copy_leftover,"ax",%progbits
  70              		.align	1
  71              		.global	copy_leftover
  72              		.syntax unified
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 6


  73              		.thumb
  74              		.thumb_func
  75              		.fpu fpv5-sp-d16
  77              	copy_leftover:
  78              	.LFB150:
 214:Src/mp3_player.c **** 
 215:Src/mp3_player.c **** // Play state handler
 216:Src/mp3_player.c **** void mp3_player_play(void)
 217:Src/mp3_player.c **** {
 218:Src/mp3_player.c **** 	if(DEBUG_ON) xprintf("play: initializing decoder\n");
 219:Src/mp3_player.c **** 	hMP3Decoder = MP3InitDecoder();
 220:Src/mp3_player.c **** 
 221:Src/mp3_player.c ****     if(DEBUG_ON) xprintf("play: starting frame processing\n");
 222:Src/mp3_player.c **** 	if(mp3_player_process_frame() == 0) {
 223:Src/mp3_player.c **** 		state = PLAY;
 224:Src/mp3_player.c **** 		BSP_AUDIO_OUT_Play((uint16_t*)&output_buffer[0], AUDIO_OUT_BUFFER_SIZE * 2);
 225:Src/mp3_player.c **** 		while(1) {
 226:Src/mp3_player.c **** 			update_progress_bar(((double)currentFileBytesRead) / currentFileBytes);
 227:Src/mp3_player.c **** 			Mp3_Player_State newState = check_touchscreen();
 228:Src/mp3_player.c **** 			if (newState != EMPTY)
 229:Src/mp3_player.c **** 				state = newState;
 230:Src/mp3_player.c ****             if (!has_been_paused && state == PAUSE) {
 231:Src/mp3_player.c **** 				sprintf(gui_info_text, "PAUSED");
 232:Src/mp3_player.c **** 				refresh_screen(gui_info_text);
 233:Src/mp3_player.c **** 				if(BSP_AUDIO_OUT_Pause() != AUDIO_OK) {
 234:Src/mp3_player.c **** 					xprintf("Error while pausing stream\n");
 235:Src/mp3_player.c **** 					return;
 236:Src/mp3_player.c **** 				}
 237:Src/mp3_player.c **** 				has_been_paused = 1;
 238:Src/mp3_player.c ****             } else if(has_been_paused && state == PLAY) {
 239:Src/mp3_player.c **** 				sprintf(gui_info_text, "%s", paths[currentFilePosition]);
 240:Src/mp3_player.c **** 				refresh_screen(gui_info_text);
 241:Src/mp3_player.c **** 				if(BSP_AUDIO_OUT_Resume() != AUDIO_OK) {
 242:Src/mp3_player.c **** 					xprintf("Error while pausing stream\n");
 243:Src/mp3_player.c **** 					return;
 244:Src/mp3_player.c **** 				}
 245:Src/mp3_player.c **** 				has_been_paused = 0;
 246:Src/mp3_player.c **** 			}  else if (has_been_paused && state == PAUSE)
 247:Src/mp3_player.c **** 				continue;
 248:Src/mp3_player.c **** 			else if (state != PLAY) {
 249:Src/mp3_player.c ****                 break;
 250:Src/mp3_player.c ****             }
 251:Src/mp3_player.c **** 		}
 252:Src/mp3_player.c **** 		BSP_AUDIO_OUT_Stop(CODEC_PDWN_SW);
 253:Src/mp3_player.c **** 		out_buf_offs = BUFFER_OFFSET_NONE;
 254:Src/mp3_player.c **** 	}
 255:Src/mp3_player.c **** 	else
 256:Src/mp3_player.c **** 	{
 257:Src/mp3_player.c **** 		state = NEXT;
 258:Src/mp3_player.c **** 	}
 259:Src/mp3_player.c **** 
 260:Src/mp3_player.c **** 	buffer_leftover = 0;
 261:Src/mp3_player.c **** 	current_ptr = NULL;
 262:Src/mp3_player.c **** 	MP3FreeDecoder(hMP3Decoder);
 263:Src/mp3_player.c **** 
 264:Src/mp3_player.c **** 	if(DEBUG_ON) xprintf("play: freeing decoder\n");
 265:Src/mp3_player.c **** }
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 7


 266:Src/mp3_player.c **** 
 267:Src/mp3_player.c **** // Process next mp3 frame from the main file
 268:Src/mp3_player.c **** int mp3_player_process_frame(void)
 269:Src/mp3_player.c **** {
 270:Src/mp3_player.c ****     if(DEBUG_ON) xprintf("process: starting\n");
 271:Src/mp3_player.c **** 	MP3FrameInfo mp3FrameInfo;
 272:Src/mp3_player.c **** 
 273:Src/mp3_player.c **** 	if (current_ptr == NULL && fill_input_buffer() != 0) return EOF;
 274:Src/mp3_player.c **** 
 275:Src/mp3_player.c **** 	in_buf_offs = MP3FindSyncWord(current_ptr, buffer_leftover);
 276:Src/mp3_player.c **** 	while(in_buf_offs < 0)
 277:Src/mp3_player.c **** 	{
 278:Src/mp3_player.c **** 		if(fill_input_buffer() != 0) return EOF;
 279:Src/mp3_player.c **** 		// TODO check if this if is necessary at all
 280:Src/mp3_player.c **** 		if(buffer_leftover > 0)
 281:Src/mp3_player.c **** 		{
 282:Src/mp3_player.c **** 			buffer_leftover--;
 283:Src/mp3_player.c **** 			current_ptr++;
 284:Src/mp3_player.c **** 		}
 285:Src/mp3_player.c **** 		// END TODO
 286:Src/mp3_player.c **** 		in_buf_offs = MP3FindSyncWord(current_ptr, buffer_leftover);
 287:Src/mp3_player.c **** 	}
 288:Src/mp3_player.c **** 	current_ptr += in_buf_offs;
 289:Src/mp3_player.c **** 	buffer_leftover -= in_buf_offs;
 290:Src/mp3_player.c **** 
 291:Src/mp3_player.c **** 	if(DEBUG_ON) xprintf("process: findSyncWord read\n");
 292:Src/mp3_player.c **** 
 293:Src/mp3_player.c **** 	// get data from the frame header
 294:Src/mp3_player.c **** 	if(!(MP3GetNextFrameInfo(hMP3Decoder, &mp3FrameInfo, current_ptr) == 0 && mp3FrameInfo.nChans == 2
 295:Src/mp3_player.c **** 	{
 296:Src/mp3_player.c **** 		// if header has failed
 297:Src/mp3_player.c **** 		if(buffer_leftover > 0)
 298:Src/mp3_player.c **** 		{
 299:Src/mp3_player.c **** 			buffer_leftover--;
 300:Src/mp3_player.c **** 			current_ptr++;
 301:Src/mp3_player.c **** 		}
 302:Src/mp3_player.c **** 		return 0;
 303:Src/mp3_player.c **** 	}
 304:Src/mp3_player.c **** 
 305:Src/mp3_player.c **** 	// if feel the buffer with actual non-frame-header data if necessary
 306:Src/mp3_player.c **** 	if (buffer_leftover < MAINBUF_SIZE && fill_input_buffer() != 0) return EOF;
 307:Src/mp3_player.c **** 
 308:Src/mp3_player.c **** 	// decode the right portion of the buffer
 309:Src/mp3_player.c **** 	if(out_buf_offs == BUFFER_OFFSET_HALF)
 310:Src/mp3_player.c **** 	{
 311:Src/mp3_player.c **** 	    if(DEBUG_ON) xprintf("process: out_buf half\n");
 312:Src/mp3_player.c **** 		decode_result = MP3Decode(hMP3Decoder, &current_ptr, &buffer_leftover, output_buffer, 0);
 313:Src/mp3_player.c **** 		out_buf_offs = BUFFER_OFFSET_NONE;
 314:Src/mp3_player.c **** 	}
 315:Src/mp3_player.c **** 
 316:Src/mp3_player.c **** 	if(out_buf_offs == BUFFER_OFFSET_FULL)
 317:Src/mp3_player.c **** 	{
 318:Src/mp3_player.c ****         if(DEBUG_ON) xprintf("process: out_buf full\n");
 319:Src/mp3_player.c **** 		decode_result = MP3Decode(hMP3Decoder, &current_ptr, &buffer_leftover, &output_buffer[DECODED_MP3
 320:Src/mp3_player.c **** 		out_buf_offs = BUFFER_OFFSET_NONE;
 321:Src/mp3_player.c **** 	}
 322:Src/mp3_player.c **** 
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 8


 323:Src/mp3_player.c **** 	// check results of the decoding process
 324:Src/mp3_player.c **** 	if(decode_result != ERR_MP3_NONE)
 325:Src/mp3_player.c **** 	{
 326:Src/mp3_player.c **** 		if(decode_result == ERR_MP3_INDATA_UNDERFLOW)
 327:Src/mp3_player.c **** 		{
 328:Src/mp3_player.c **** 			buffer_leftover = 0;
 329:Src/mp3_player.c **** 			if(fill_input_buffer() != 0) return EOF;
 330:Src/mp3_player.c **** 		}
 331:Src/mp3_player.c **** 		else if(decode_result == ERR_UNKNOWN)
 332:Src/mp3_player.c **** 		{
 333:Src/mp3_player.c **** 			xprintf("An unkown error has occured while decoding the frame\n");
 334:Src/mp3_player.c **** 		}
 335:Src/mp3_player.c **** 	}
 336:Src/mp3_player.c **** 
 337:Src/mp3_player.c **** 	return 0;
 338:Src/mp3_player.c **** }
 339:Src/mp3_player.c **** 
 340:Src/mp3_player.c **** // Callback when half of audio out buffer is transefered
 341:Src/mp3_player.c **** void BSP_AUDIO_OUT_TransferComplete_CallBack(void)
 342:Src/mp3_player.c **** {
 343:Src/mp3_player.c ****     out_buf_offs = BUFFER_OFFSET_FULL;
 344:Src/mp3_player.c **** 
 345:Src/mp3_player.c **** 	if(mp3_player_process_frame() != 0)
 346:Src/mp3_player.c **** 	{
 347:Src/mp3_player.c **** 		BSP_AUDIO_OUT_Stop(CODEC_PDWN_SW);
 348:Src/mp3_player.c **** 		state = NEXT;
 349:Src/mp3_player.c **** 	}
 350:Src/mp3_player.c **** }
 351:Src/mp3_player.c **** 
 352:Src/mp3_player.c **** // Callback when all of audio out buffer is transefered
 353:Src/mp3_player.c **** void BSP_AUDIO_OUT_HalfTransfer_CallBack(void)
 354:Src/mp3_player.c **** {
 355:Src/mp3_player.c ****     out_buf_offs = BUFFER_OFFSET_HALF;
 356:Src/mp3_player.c **** 
 357:Src/mp3_player.c **** 	if(mp3_player_process_frame() != 0)
 358:Src/mp3_player.c **** 	{
 359:Src/mp3_player.c **** 		BSP_AUDIO_OUT_Stop(CODEC_PDWN_SW);
 360:Src/mp3_player.c **** 		state = NEXT;
 361:Src/mp3_player.c **** 	}
 362:Src/mp3_player.c **** }
 363:Src/mp3_player.c **** 
 364:Src/mp3_player.c **** // Fill the input buffer with mp3 data from the USB for the decoder
 365:Src/mp3_player.c **** int fill_input_buffer() 
 366:Src/mp3_player.c **** {
 367:Src/mp3_player.c **** 	unsigned int actually_read, how_much_to_read;
 368:Src/mp3_player.c **** 
 369:Src/mp3_player.c **** 	copy_leftover();
 370:Src/mp3_player.c **** 
 371:Src/mp3_player.c **** 	if(DEBUG_ON) xprintf("fill: copied from current_ptr input_buffer\n");
 372:Src/mp3_player.c **** 
 373:Src/mp3_player.c **** 	how_much_to_read = READ_BUFFER_SIZE - buffer_leftover;
 374:Src/mp3_player.c **** 
 375:Src/mp3_player.c **** 	// read from the input_file to fill the input_buffer fully
 376:Src/mp3_player.c **** 	f_read(&input_file, (BYTE *)input_buffer + buffer_leftover, how_much_to_read, &actually_read);
 377:Src/mp3_player.c **** 
 378:Src/mp3_player.c **** 	currentFileBytesRead += actually_read;
 379:Src/mp3_player.c **** 
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 9


 380:Src/mp3_player.c **** 	if(DEBUG_ON) xprintf("fill: copied from file to input_buffer\n");
 381:Src/mp3_player.c **** 
 382:Src/mp3_player.c **** 	// if there's still data in  the file
 383:Src/mp3_player.c **** 	if (actually_read == how_much_to_read)
 384:Src/mp3_player.c **** 	{
 385:Src/mp3_player.c **** 		current_ptr = input_buffer;
 386:Src/mp3_player.c **** 		in_buf_offs = 0;
 387:Src/mp3_player.c **** 		buffer_leftover = READ_BUFFER_SIZE;
 388:Src/mp3_player.c **** 		return 0;
 389:Src/mp3_player.c **** 	}
 390:Src/mp3_player.c **** 	else return EOF;
 391:Src/mp3_player.c **** }
 392:Src/mp3_player.c **** 
 393:Src/mp3_player.c **** // if there is some data left in the buffer copy it to the beginning
 394:Src/mp3_player.c **** void copy_leftover() 
 395:Src/mp3_player.c **** {
  79              		.loc 1 395 0
  80              		.cfi_startproc
  81              		@ args = 0, pretend = 0, frame = 0
  82              		@ frame_needed = 0, uses_anonymous_args = 0
  83 0000 08B5     		push	{r3, lr}
  84              	.LCFI1:
  85              		.cfi_def_cfa_offset 8
  86              		.cfi_offset 3, -8
  87              		.cfi_offset 14, -4
 396:Src/mp3_player.c **** 	if(buffer_leftover > 0)
  88              		.loc 1 396 0
  89 0002 054B     		ldr	r3, .L11
  90 0004 1A68     		ldr	r2, [r3]
  91 0006 002A     		cmp	r2, #0
  92 0008 04DD     		ble	.L8
 397:Src/mp3_player.c **** 	{
 398:Src/mp3_player.c **** 		memcpy(input_buffer, current_ptr, buffer_leftover);
  93              		.loc 1 398 0
  94 000a 044B     		ldr	r3, .L11+4
  95 000c 1968     		ldr	r1, [r3]
  96 000e 0448     		ldr	r0, .L11+8
  97 0010 FFF7FEFF 		bl	memcpy
  98              	.LVL4:
  99              	.L8:
 399:Src/mp3_player.c **** 	}
 400:Src/mp3_player.c **** }
 100              		.loc 1 400 0
 101 0014 08BD     		pop	{r3, pc}
 102              	.L12:
 103 0016 00BF     		.align	2
 104              	.L11:
 105 0018 00000000 		.word	.LANCHOR0
 106 001c 00000000 		.word	.LANCHOR1
 107 0020 00000000 		.word	input_buffer
 108              		.cfi_endproc
 109              	.LFE150:
 111              		.section	.text.fill_input_buffer,"ax",%progbits
 112              		.align	1
 113              		.global	fill_input_buffer
 114              		.syntax unified
 115              		.thumb
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 10


 116              		.thumb_func
 117              		.fpu fpv5-sp-d16
 119              	fill_input_buffer:
 120              	.LFB149:
 366:Src/mp3_player.c **** 	unsigned int actually_read, how_much_to_read;
 121              		.loc 1 366 0
 122              		.cfi_startproc
 123              		@ args = 0, pretend = 0, frame = 8
 124              		@ frame_needed = 0, uses_anonymous_args = 0
 125 0000 10B5     		push	{r4, lr}
 126              	.LCFI2:
 127              		.cfi_def_cfa_offset 8
 128              		.cfi_offset 4, -8
 129              		.cfi_offset 14, -4
 130 0002 82B0     		sub	sp, sp, #8
 131              	.LCFI3:
 132              		.cfi_def_cfa_offset 16
 369:Src/mp3_player.c **** 
 133              		.loc 1 369 0
 134 0004 FFF7FEFF 		bl	copy_leftover
 135              	.LVL5:
 371:Src/mp3_player.c **** 
 136              		.loc 1 371 0
 137 0008 1448     		ldr	r0, .L17
 138 000a FFF7FEFF 		bl	xprintf
 139              	.LVL6:
 373:Src/mp3_player.c **** 
 140              		.loc 1 373 0
 141 000e 144B     		ldr	r3, .L17+4
 142 0010 1968     		ldr	r1, [r3]
 143 0012 40F62874 		movw	r4, #3880
 144 0016 641A     		subs	r4, r4, r1
 145              	.LVL7:
 376:Src/mp3_player.c **** 
 146              		.loc 1 376 0
 147 0018 01AB     		add	r3, sp, #4
 148 001a 2246     		mov	r2, r4
 149 001c 1148     		ldr	r0, .L17+8
 150 001e 0144     		add	r1, r1, r0
 151 0020 1148     		ldr	r0, .L17+12
 152 0022 FFF7FEFF 		bl	f_read
 153              	.LVL8:
 378:Src/mp3_player.c **** 
 154              		.loc 1 378 0
 155 0026 114A     		ldr	r2, .L17+16
 156 0028 1368     		ldr	r3, [r2]
 157 002a 0199     		ldr	r1, [sp, #4]
 158 002c 0B44     		add	r3, r3, r1
 159 002e 1360     		str	r3, [r2]
 380:Src/mp3_player.c **** 
 160              		.loc 1 380 0
 161 0030 0F48     		ldr	r0, .L17+20
 162 0032 FFF7FEFF 		bl	xprintf
 163              	.LVL9:
 383:Src/mp3_player.c **** 	{
 164              		.loc 1 383 0
 165 0036 019B     		ldr	r3, [sp, #4]
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 11


 166 0038 A342     		cmp	r3, r4
 167 003a 0BD1     		bne	.L15
 385:Src/mp3_player.c **** 		in_buf_offs = 0;
 168              		.loc 1 385 0
 169 003c 0D4B     		ldr	r3, .L17+24
 170 003e 094A     		ldr	r2, .L17+8
 171 0040 1A60     		str	r2, [r3]
 386:Src/mp3_player.c **** 		buffer_leftover = READ_BUFFER_SIZE;
 172              		.loc 1 386 0
 173 0042 0020     		movs	r0, #0
 174 0044 0C4B     		ldr	r3, .L17+28
 175 0046 1860     		str	r0, [r3]
 387:Src/mp3_player.c **** 		return 0;
 176              		.loc 1 387 0
 177 0048 054B     		ldr	r3, .L17+4
 178 004a 40F62872 		movw	r2, #3880
 179 004e 1A60     		str	r2, [r3]
 180              	.L13:
 391:Src/mp3_player.c **** 
 181              		.loc 1 391 0
 182 0050 02B0     		add	sp, sp, #8
 183              	.LCFI4:
 184              		.cfi_remember_state
 185              		.cfi_def_cfa_offset 8
 186              		@ sp needed
 187 0052 10BD     		pop	{r4, pc}
 188              	.LVL10:
 189              	.L15:
 190              	.LCFI5:
 191              		.cfi_restore_state
 390:Src/mp3_player.c **** }
 192              		.loc 1 390 0
 193 0054 4FF0FF30 		mov	r0, #-1
 194 0058 FAE7     		b	.L13
 195              	.L18:
 196 005a 00BF     		.align	2
 197              	.L17:
 198 005c 00000000 		.word	.LC2
 199 0060 00000000 		.word	.LANCHOR0
 200 0064 00000000 		.word	input_buffer
 201 0068 00000000 		.word	input_file
 202 006c 00000000 		.word	.LANCHOR2
 203 0070 2C000000 		.word	.LC3
 204 0074 00000000 		.word	.LANCHOR1
 205 0078 00000000 		.word	.LANCHOR3
 206              		.cfi_endproc
 207              	.LFE149:
 209              		.section	.text.mp3_player_process_frame,"ax",%progbits
 210              		.align	1
 211              		.global	mp3_player_process_frame
 212              		.syntax unified
 213              		.thumb
 214              		.thumb_func
 215              		.fpu fpv5-sp-d16
 217              	mp3_player_process_frame:
 218              	.LFB146:
 269:Src/mp3_player.c ****     if(DEBUG_ON) xprintf("process: starting\n");
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 12


 219              		.loc 1 269 0
 220              		.cfi_startproc
 221              		@ args = 0, pretend = 0, frame = 32
 222              		@ frame_needed = 0, uses_anonymous_args = 0
 223 0000 30B5     		push	{r4, r5, lr}
 224              	.LCFI6:
 225              		.cfi_def_cfa_offset 12
 226              		.cfi_offset 4, -12
 227              		.cfi_offset 5, -8
 228              		.cfi_offset 14, -4
 229 0002 8BB0     		sub	sp, sp, #44
 230              	.LCFI7:
 231              		.cfi_def_cfa_offset 56
 270:Src/mp3_player.c **** 	MP3FrameInfo mp3FrameInfo;
 232              		.loc 1 270 0
 233 0004 5748     		ldr	r0, .L46
 234 0006 FFF7FEFF 		bl	xprintf
 235              	.LVL11:
 273:Src/mp3_player.c **** 
 236              		.loc 1 273 0
 237 000a 574B     		ldr	r3, .L46+4
 238 000c 1B68     		ldr	r3, [r3]
 239 000e 43B1     		cbz	r3, .L38
 240              	.L20:
 275:Src/mp3_player.c **** 	while(in_buf_offs < 0)
 241              		.loc 1 275 0
 242 0010 564B     		ldr	r3, .L46+8
 243 0012 1968     		ldr	r1, [r3]
 244 0014 544B     		ldr	r3, .L46+4
 245 0016 1868     		ldr	r0, [r3]
 246 0018 FFF7FEFF 		bl	MP3FindSyncWord
 247              	.LVL12:
 248 001c 544B     		ldr	r3, .L46+12
 249 001e 1860     		str	r0, [r3]
 276:Src/mp3_player.c **** 	{
 250              		.loc 1 276 0
 251 0020 0EE0     		b	.L22
 252              	.L38:
 273:Src/mp3_player.c **** 
 253              		.loc 1 273 0 discriminator 1
 254 0022 FFF7FEFF 		bl	fill_input_buffer
 255              	.LVL13:
 256 0026 0028     		cmp	r0, #0
 257 0028 F2D0     		beq	.L20
 273:Src/mp3_player.c **** 
 258              		.loc 1 273 0 is_stmt 0
 259 002a 4FF0FF34 		mov	r4, #-1
 260 002e 93E0     		b	.L19
 261              	.L23:
 286:Src/mp3_player.c **** 	}
 262              		.loc 1 286 0 is_stmt 1
 263 0030 4E4B     		ldr	r3, .L46+8
 264 0032 1968     		ldr	r1, [r3]
 265 0034 4C4B     		ldr	r3, .L46+4
 266 0036 1868     		ldr	r0, [r3]
 267 0038 FFF7FEFF 		bl	MP3FindSyncWord
 268              	.LVL14:
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 13


 269 003c 4C4B     		ldr	r3, .L46+12
 270 003e 1860     		str	r0, [r3]
 271              	.L22:
 276:Src/mp3_player.c **** 	{
 272              		.loc 1 276 0
 273 0040 4B4B     		ldr	r3, .L46+12
 274 0042 1B68     		ldr	r3, [r3]
 275 0044 002B     		cmp	r3, #0
 276 0046 10DA     		bge	.L39
 278:Src/mp3_player.c **** 		// TODO check if this if is necessary at all
 277              		.loc 1 278 0
 278 0048 FFF7FEFF 		bl	fill_input_buffer
 279              	.LVL15:
 280 004c 0028     		cmp	r0, #0
 281 004e 40F08180 		bne	.L32
 280:Src/mp3_player.c **** 		{
 282              		.loc 1 280 0
 283 0052 464B     		ldr	r3, .L46+8
 284 0054 1B68     		ldr	r3, [r3]
 285 0056 002B     		cmp	r3, #0
 286 0058 EADD     		ble	.L23
 282:Src/mp3_player.c **** 			current_ptr++;
 287              		.loc 1 282 0
 288 005a 013B     		subs	r3, r3, #1
 289 005c 434A     		ldr	r2, .L46+8
 290 005e 1360     		str	r3, [r2]
 283:Src/mp3_player.c **** 		}
 291              		.loc 1 283 0
 292 0060 414A     		ldr	r2, .L46+4
 293 0062 1368     		ldr	r3, [r2]
 294 0064 0133     		adds	r3, r3, #1
 295 0066 1360     		str	r3, [r2]
 296 0068 E2E7     		b	.L23
 297              	.L39:
 288:Src/mp3_player.c **** 	buffer_leftover -= in_buf_offs;
 298              		.loc 1 288 0
 299 006a 3F4C     		ldr	r4, .L46+4
 300 006c 2268     		ldr	r2, [r4]
 301 006e 1A44     		add	r2, r2, r3
 302 0070 2260     		str	r2, [r4]
 289:Src/mp3_player.c **** 
 303              		.loc 1 289 0
 304 0072 3E49     		ldr	r1, .L46+8
 305 0074 0A68     		ldr	r2, [r1]
 306 0076 D31A     		subs	r3, r2, r3
 307 0078 0B60     		str	r3, [r1]
 291:Src/mp3_player.c **** 
 308              		.loc 1 291 0
 309 007a 3E48     		ldr	r0, .L46+16
 310 007c FFF7FEFF 		bl	xprintf
 311              	.LVL16:
 294:Src/mp3_player.c **** 	{
 312              		.loc 1 294 0
 313 0080 2268     		ldr	r2, [r4]
 314 0082 03A9     		add	r1, sp, #12
 315 0084 3C4B     		ldr	r3, .L46+20
 316 0086 1868     		ldr	r0, [r3]
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 14


 317 0088 FFF7FEFF 		bl	MP3GetNextFrameInfo
 318              	.LVL17:
 319 008c 10B9     		cbnz	r0, .L25
 294:Src/mp3_player.c **** 	{
 320              		.loc 1 294 0 is_stmt 0 discriminator 1
 321 008e 049B     		ldr	r3, [sp, #16]
 322 0090 022B     		cmp	r3, #2
 323 0092 0CD0     		beq	.L40
 324              	.L25:
 297:Src/mp3_player.c **** 		{
 325              		.loc 1 297 0 is_stmt 1
 326 0094 354B     		ldr	r3, .L46+8
 327 0096 1B68     		ldr	r3, [r3]
 328 0098 002B     		cmp	r3, #0
 329 009a 60DD     		ble	.L33
 299:Src/mp3_player.c **** 			current_ptr++;
 330              		.loc 1 299 0
 331 009c 013B     		subs	r3, r3, #1
 332 009e 334A     		ldr	r2, .L46+8
 333 00a0 1360     		str	r3, [r2]
 300:Src/mp3_player.c **** 		}
 334              		.loc 1 300 0
 335 00a2 314A     		ldr	r2, .L46+4
 336 00a4 1368     		ldr	r3, [r2]
 337 00a6 0133     		adds	r3, r3, #1
 338 00a8 1360     		str	r3, [r2]
 302:Src/mp3_player.c **** 	}
 339              		.loc 1 302 0
 340 00aa 0024     		movs	r4, #0
 341 00ac 54E0     		b	.L19
 342              	.L40:
 294:Src/mp3_player.c **** 	{
 343              		.loc 1 294 0 discriminator 2
 344 00ae 099D     		ldr	r5, [sp, #36]
 345 00b0 002D     		cmp	r5, #0
 346 00b2 EFD1     		bne	.L25
 306:Src/mp3_player.c **** 
 347              		.loc 1 306 0
 348 00b4 2D4B     		ldr	r3, .L46+8
 349 00b6 1A68     		ldr	r2, [r3]
 350 00b8 40F29373 		movw	r3, #1939
 351 00bc 9A42     		cmp	r2, r3
 352 00be 13DD     		ble	.L41
 353              	.L27:
 309:Src/mp3_player.c **** 	{
 354              		.loc 1 309 0
 355 00c0 2E4B     		ldr	r3, .L46+24
 356 00c2 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 357 00c4 012B     		cmp	r3, #1
 358 00c6 16D0     		beq	.L42
 359              	.L28:
 316:Src/mp3_player.c **** 	{
 360              		.loc 1 316 0
 361 00c8 2C4B     		ldr	r3, .L46+24
 362 00ca 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 363 00cc 022B     		cmp	r3, #2
 364 00ce 23D0     		beq	.L43
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 15


 365              	.L29:
 324:Src/mp3_player.c **** 	{
 366              		.loc 1 324 0
 367 00d0 2B4B     		ldr	r3, .L46+28
 368 00d2 1C68     		ldr	r4, [r3]
 369 00d4 002C     		cmp	r4, #0
 370 00d6 3FD0     		beq	.L19
 326:Src/mp3_player.c **** 		{
 371              		.loc 1 326 0
 372 00d8 B4F1FF3F 		cmp	r4, #-1
 373 00dc 2DD0     		beq	.L44
 331:Src/mp3_player.c **** 		{
 374              		.loc 1 331 0
 375 00de 294B     		ldr	r3, .L46+32
 376 00e0 9C42     		cmp	r4, r3
 377 00e2 32D0     		beq	.L45
 337:Src/mp3_player.c **** }
 378              		.loc 1 337 0
 379 00e4 2C46     		mov	r4, r5
 380 00e6 37E0     		b	.L19
 381              	.L41:
 306:Src/mp3_player.c **** 
 382              		.loc 1 306 0 discriminator 1
 383 00e8 FFF7FEFF 		bl	fill_input_buffer
 384              	.LVL18:
 385 00ec 0028     		cmp	r0, #0
 386 00ee E7D0     		beq	.L27
 306:Src/mp3_player.c **** 
 387              		.loc 1 306 0 is_stmt 0
 388 00f0 4FF0FF34 		mov	r4, #-1
 389 00f4 30E0     		b	.L19
 390              	.L42:
 311:Src/mp3_player.c **** 		decode_result = MP3Decode(hMP3Decoder, &current_ptr, &buffer_leftover, output_buffer, 0);
 391              		.loc 1 311 0 is_stmt 1 discriminator 1
 392 00f6 2448     		ldr	r0, .L46+36
 393 00f8 FFF7FEFF 		bl	xprintf
 394              	.LVL19:
 312:Src/mp3_player.c **** 		out_buf_offs = BUFFER_OFFSET_NONE;
 395              		.loc 1 312 0 discriminator 1
 396 00fc 1E4B     		ldr	r3, .L46+20
 397 00fe 1868     		ldr	r0, [r3]
 398 0100 0024     		movs	r4, #0
 399 0102 0094     		str	r4, [sp]
 400 0104 214B     		ldr	r3, .L46+40
 401 0106 194A     		ldr	r2, .L46+8
 402 0108 1749     		ldr	r1, .L46+4
 403 010a FFF7FEFF 		bl	MP3Decode
 404              	.LVL20:
 405 010e 1C4B     		ldr	r3, .L46+28
 406 0110 1860     		str	r0, [r3]
 313:Src/mp3_player.c **** 	}
 407              		.loc 1 313 0 discriminator 1
 408 0112 1A4B     		ldr	r3, .L46+24
 409 0114 1C70     		strb	r4, [r3]
 410 0116 D7E7     		b	.L28
 411              	.L43:
 318:Src/mp3_player.c **** 		decode_result = MP3Decode(hMP3Decoder, &current_ptr, &buffer_leftover, &output_buffer[DECODED_MP3
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 16


 412              		.loc 1 318 0 discriminator 1
 413 0118 1D48     		ldr	r0, .L46+44
 414 011a FFF7FEFF 		bl	xprintf
 415              	.LVL21:
 319:Src/mp3_player.c **** 		out_buf_offs = BUFFER_OFFSET_NONE;
 416              		.loc 1 319 0 discriminator 1
 417 011e 164B     		ldr	r3, .L46+20
 418 0120 1868     		ldr	r0, [r3]
 419 0122 0024     		movs	r4, #0
 420 0124 0094     		str	r4, [sp]
 421 0126 1B4B     		ldr	r3, .L46+48
 422 0128 104A     		ldr	r2, .L46+8
 423 012a 0F49     		ldr	r1, .L46+4
 424 012c FFF7FEFF 		bl	MP3Decode
 425              	.LVL22:
 426 0130 134B     		ldr	r3, .L46+28
 427 0132 1860     		str	r0, [r3]
 320:Src/mp3_player.c **** 	}
 428              		.loc 1 320 0 discriminator 1
 429 0134 114B     		ldr	r3, .L46+24
 430 0136 1C70     		strb	r4, [r3]
 431 0138 CAE7     		b	.L29
 432              	.L44:
 328:Src/mp3_player.c **** 			if(fill_input_buffer() != 0) return EOF;
 433              		.loc 1 328 0
 434 013a 0C4B     		ldr	r3, .L46+8
 435 013c 0022     		movs	r2, #0
 436 013e 1A60     		str	r2, [r3]
 329:Src/mp3_player.c **** 		}
 437              		.loc 1 329 0
 438 0140 FFF7FEFF 		bl	fill_input_buffer
 439              	.LVL23:
 440 0144 40B9     		cbnz	r0, .L19
 337:Src/mp3_player.c **** }
 441              		.loc 1 337 0
 442 0146 0446     		mov	r4, r0
 443 0148 06E0     		b	.L19
 444              	.L45:
 333:Src/mp3_player.c **** 		}
 445              		.loc 1 333 0
 446 014a 1348     		ldr	r0, .L46+52
 447 014c FFF7FEFF 		bl	xprintf
 448              	.LVL24:
 337:Src/mp3_player.c **** }
 449              		.loc 1 337 0
 450 0150 2C46     		mov	r4, r5
 451 0152 01E0     		b	.L19
 452              	.L32:
 278:Src/mp3_player.c **** 		// TODO check if this if is necessary at all
 453              		.loc 1 278 0
 454 0154 4FF0FF34 		mov	r4, #-1
 455              	.L19:
 338:Src/mp3_player.c **** 
 456              		.loc 1 338 0
 457 0158 2046     		mov	r0, r4
 458 015a 0BB0     		add	sp, sp, #44
 459              	.LCFI8:
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 17


 460              		.cfi_remember_state
 461              		.cfi_def_cfa_offset 12
 462              		@ sp needed
 463 015c 30BD     		pop	{r4, r5, pc}
 464              	.L33:
 465              	.LCFI9:
 466              		.cfi_restore_state
 302:Src/mp3_player.c **** 	}
 467              		.loc 1 302 0
 468 015e 0024     		movs	r4, #0
 469 0160 FAE7     		b	.L19
 470              	.L47:
 471 0162 00BF     		.align	2
 472              	.L46:
 473 0164 00000000 		.word	.LC4
 474 0168 00000000 		.word	.LANCHOR1
 475 016c 00000000 		.word	.LANCHOR0
 476 0170 00000000 		.word	.LANCHOR3
 477 0174 14000000 		.word	.LC5
 478 0178 00000000 		.word	.LANCHOR4
 479 017c 00000000 		.word	.LANCHOR5
 480 0180 00000000 		.word	.LANCHOR6
 481 0184 F1D8FFFF 		.word	-9999
 482 0188 30000000 		.word	.LC6
 483 018c 00000000 		.word	output_buffer
 484 0190 48000000 		.word	.LC7
 485 0194 00120000 		.word	output_buffer+4608
 486 0198 60000000 		.word	.LC8
 487              		.cfi_endproc
 488              	.LFE146:
 490              		.global	__aeabi_i2d
 491              		.global	__aeabi_ddiv
 492              		.section	.text.mp3_player_play,"ax",%progbits
 493              		.align	1
 494              		.global	mp3_player_play
 495              		.syntax unified
 496              		.thumb
 497              		.thumb_func
 498              		.fpu fpv5-sp-d16
 500              	mp3_player_play:
 501              	.LFB145:
 217:Src/mp3_player.c **** 	if(DEBUG_ON) xprintf("play: initializing decoder\n");
 502              		.loc 1 217 0
 503              		.cfi_startproc
 504              		@ args = 0, pretend = 0, frame = 0
 505              		@ frame_needed = 0, uses_anonymous_args = 0
 506 0000 38B5     		push	{r3, r4, r5, lr}
 507              	.LCFI10:
 508              		.cfi_def_cfa_offset 16
 509              		.cfi_offset 3, -16
 510              		.cfi_offset 4, -12
 511              		.cfi_offset 5, -8
 512              		.cfi_offset 14, -4
 218:Src/mp3_player.c **** 	hMP3Decoder = MP3InitDecoder();
 513              		.loc 1 218 0
 514 0002 4548     		ldr	r0, .L67
 515 0004 FFF7FEFF 		bl	xprintf
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 18


 516              	.LVL25:
 219:Src/mp3_player.c **** 
 517              		.loc 1 219 0
 518 0008 FFF7FEFF 		bl	MP3InitDecoder
 519              	.LVL26:
 520 000c 434B     		ldr	r3, .L67+4
 521 000e 1860     		str	r0, [r3]
 221:Src/mp3_player.c **** 	if(mp3_player_process_frame() == 0) {
 522              		.loc 1 221 0
 523 0010 4348     		ldr	r0, .L67+8
 524 0012 FFF7FEFF 		bl	xprintf
 525              	.LVL27:
 222:Src/mp3_player.c **** 		state = PLAY;
 526              		.loc 1 222 0
 527 0016 FFF7FEFF 		bl	mp3_player_process_frame
 528              	.LVL28:
 529 001a 78B1     		cbz	r0, .L61
 257:Src/mp3_player.c **** 	}
 530              		.loc 1 257 0
 531 001c 414B     		ldr	r3, .L67+12
 532 001e 0322     		movs	r2, #3
 533 0020 1A70     		strb	r2, [r3]
 534              	.L59:
 260:Src/mp3_player.c **** 	current_ptr = NULL;
 535              		.loc 1 260 0
 536 0022 0023     		movs	r3, #0
 537 0024 404A     		ldr	r2, .L67+16
 538 0026 1360     		str	r3, [r2]
 261:Src/mp3_player.c **** 	MP3FreeDecoder(hMP3Decoder);
 539              		.loc 1 261 0
 540 0028 404A     		ldr	r2, .L67+20
 541 002a 1360     		str	r3, [r2]
 262:Src/mp3_player.c **** 
 542              		.loc 1 262 0
 543 002c 3B4B     		ldr	r3, .L67+4
 544 002e 1868     		ldr	r0, [r3]
 545 0030 FFF7FEFF 		bl	MP3FreeDecoder
 546              	.LVL29:
 264:Src/mp3_player.c **** }
 547              		.loc 1 264 0
 548 0034 3E48     		ldr	r0, .L67+24
 549 0036 FFF7FEFF 		bl	xprintf
 550              	.LVL30:
 551              	.L48:
 265:Src/mp3_player.c **** 
 552              		.loc 1 265 0
 553 003a 38BD     		pop	{r3, r4, r5, pc}
 554              	.L61:
 223:Src/mp3_player.c **** 		BSP_AUDIO_OUT_Play((uint16_t*)&output_buffer[0], AUDIO_OUT_BUFFER_SIZE * 2);
 555              		.loc 1 223 0
 556 003c 394B     		ldr	r3, .L67+12
 557 003e 0022     		movs	r2, #0
 558 0040 1A70     		strb	r2, [r3]
 224:Src/mp3_player.c **** 		while(1) {
 559              		.loc 1 224 0
 560 0042 4FF41051 		mov	r1, #9216
 561 0046 3B48     		ldr	r0, .L67+28
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 19


 562 0048 FFF7FEFF 		bl	BSP_AUDIO_OUT_Play
 563              	.LVL31:
 564 004c 30E0     		b	.L50
 565              	.LVL32:
 566              	.L65:
 567              	.LBB2:
 231:Src/mp3_player.c **** 				refresh_screen(gui_info_text);
 568              		.loc 1 231 0
 569 004e 3A4B     		ldr	r3, .L67+32
 570 0050 3A4A     		ldr	r2, .L67+36
 571 0052 1068     		ldr	r0, [r2]
 572              	.LVL33:
 573 0054 1860     		str	r0, [r3]	@ unaligned
 574 0056 9188     		ldrh	r1, [r2, #4]	@ unaligned
 575 0058 9279     		ldrb	r2, [r2, #6]	@ zero_extendqisi2
 576 005a 9980     		strh	r1, [r3, #4]	@ unaligned
 577 005c 9A71     		strb	r2, [r3, #6]
 232:Src/mp3_player.c **** 				if(BSP_AUDIO_OUT_Pause() != AUDIO_OK) {
 578              		.loc 1 232 0
 579 005e 1846     		mov	r0, r3
 580 0060 FFF7FEFF 		bl	refresh_screen
 581              	.LVL34:
 233:Src/mp3_player.c **** 					xprintf("Error while pausing stream\n");
 582              		.loc 1 233 0
 583 0064 FFF7FEFF 		bl	BSP_AUDIO_OUT_Pause
 584              	.LVL35:
 585 0068 18B9     		cbnz	r0, .L62
 237:Src/mp3_player.c ****             } else if(has_been_paused && state == PLAY) {
 586              		.loc 1 237 0
 587 006a 354B     		ldr	r3, .L67+40
 588 006c 0122     		movs	r2, #1
 589 006e 1A60     		str	r2, [r3]
 590 0070 1EE0     		b	.L50
 591              	.L62:
 234:Src/mp3_player.c **** 					return;
 592              		.loc 1 234 0
 593 0072 3448     		ldr	r0, .L67+44
 594 0074 FFF7FEFF 		bl	xprintf
 595              	.LVL36:
 235:Src/mp3_player.c **** 				}
 596              		.loc 1 235 0
 597 0078 DFE7     		b	.L48
 598              	.LVL37:
 599              	.L66:
 239:Src/mp3_player.c **** 				refresh_screen(gui_info_text);
 600              		.loc 1 239 0
 601 007a 334B     		ldr	r3, .L67+48
 602 007c 1A68     		ldr	r2, [r3]
 603 007e 334B     		ldr	r3, .L67+52
 604 0080 1B68     		ldr	r3, [r3]
 605 0082 2D4C     		ldr	r4, .L67+32
 606 0084 53F82210 		ldr	r1, [r3, r2, lsl #2]
 607 0088 2046     		mov	r0, r4
 608              	.LVL38:
 609 008a FFF7FEFF 		bl	strcpy
 610              	.LVL39:
 240:Src/mp3_player.c **** 				if(BSP_AUDIO_OUT_Resume() != AUDIO_OK) {
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 20


 611              		.loc 1 240 0
 612 008e 2046     		mov	r0, r4
 613 0090 FFF7FEFF 		bl	refresh_screen
 614              	.LVL40:
 241:Src/mp3_player.c **** 					xprintf("Error while pausing stream\n");
 615              		.loc 1 241 0
 616 0094 FFF7FEFF 		bl	BSP_AUDIO_OUT_Resume
 617              	.LVL41:
 618 0098 18B9     		cbnz	r0, .L63
 245:Src/mp3_player.c **** 			}  else if (has_been_paused && state == PAUSE)
 619              		.loc 1 245 0
 620 009a 294B     		ldr	r3, .L67+40
 621 009c 0022     		movs	r2, #0
 622 009e 1A60     		str	r2, [r3]
 623 00a0 06E0     		b	.L50
 624              	.L63:
 242:Src/mp3_player.c **** 					return;
 625              		.loc 1 242 0
 626 00a2 2848     		ldr	r0, .L67+44
 627 00a4 FFF7FEFF 		bl	xprintf
 628              	.LVL42:
 243:Src/mp3_player.c **** 				}
 629              		.loc 1 243 0
 630 00a8 C7E7     		b	.L48
 631              	.LVL43:
 632              	.L58:
 248:Src/mp3_player.c ****                 break;
 633              		.loc 1 248 0
 634 00aa 1E4B     		ldr	r3, .L67+12
 635 00ac 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 636 00ae 63BB     		cbnz	r3, .L64
 637              	.LVL44:
 638              	.L50:
 226:Src/mp3_player.c **** 			Mp3_Player_State newState = check_touchscreen();
 639              		.loc 1 226 0
 640 00b0 274B     		ldr	r3, .L67+56
 641 00b2 1868     		ldr	r0, [r3]
 642 00b4 FFF7FEFF 		bl	__aeabi_i2d
 643              	.LVL45:
 644 00b8 0446     		mov	r4, r0
 645 00ba 0D46     		mov	r5, r1
 646 00bc 254B     		ldr	r3, .L67+60
 647 00be 1868     		ldr	r0, [r3]
 648 00c0 FFF7FEFF 		bl	__aeabi_i2d
 649              	.LVL46:
 650 00c4 0246     		mov	r2, r0
 651 00c6 0B46     		mov	r3, r1
 652 00c8 2046     		mov	r0, r4
 653 00ca 2946     		mov	r1, r5
 654 00cc FFF7FEFF 		bl	__aeabi_ddiv
 655              	.LVL47:
 656 00d0 41EC100B 		vmov	d0, r0, r1
 657 00d4 FFF7FEFF 		bl	update_progress_bar
 658              	.LVL48:
 227:Src/mp3_player.c **** 			if (newState != EMPTY)
 659              		.loc 1 227 0
 660 00d8 FFF7FEFF 		bl	check_touchscreen
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 21


 661              	.LVL49:
 228:Src/mp3_player.c **** 				state = newState;
 662              		.loc 1 228 0
 663 00dc 0628     		cmp	r0, #6
 664 00de 01D0     		beq	.L51
 229:Src/mp3_player.c ****             if (!has_been_paused && state == PAUSE) {
 665              		.loc 1 229 0
 666 00e0 104B     		ldr	r3, .L67+12
 667 00e2 1870     		strb	r0, [r3]
 668              	.L51:
 230:Src/mp3_player.c **** 				sprintf(gui_info_text, "PAUSED");
 669              		.loc 1 230 0
 670 00e4 164B     		ldr	r3, .L67+40
 671 00e6 1B68     		ldr	r3, [r3]
 672 00e8 1BB9     		cbnz	r3, .L52
 230:Src/mp3_player.c **** 				sprintf(gui_info_text, "PAUSED");
 673              		.loc 1 230 0 is_stmt 0 discriminator 1
 674 00ea 0E4A     		ldr	r2, .L67+12
 675 00ec 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 676 00ee 012A     		cmp	r2, #1
 677 00f0 ADD0     		beq	.L65
 678              	.L52:
 238:Src/mp3_player.c **** 				sprintf(gui_info_text, "%s", paths[currentFilePosition]);
 679              		.loc 1 238 0 is_stmt 1
 680 00f2 1BB1     		cbz	r3, .L56
 238:Src/mp3_player.c **** 				sprintf(gui_info_text, "%s", paths[currentFilePosition]);
 681              		.loc 1 238 0 is_stmt 0 discriminator 1
 682 00f4 0B4A     		ldr	r2, .L67+12
 683 00f6 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 684 00f8 002A     		cmp	r2, #0
 685 00fa BED0     		beq	.L66
 686              	.L56:
 246:Src/mp3_player.c **** 				continue;
 687              		.loc 1 246 0 is_stmt 1
 688 00fc 002B     		cmp	r3, #0
 689 00fe D4D0     		beq	.L58
 246:Src/mp3_player.c **** 				continue;
 690              		.loc 1 246 0 is_stmt 0 discriminator 1
 691 0100 084B     		ldr	r3, .L67+12
 692 0102 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 693 0104 012B     		cmp	r3, #1
 694 0106 D0D1     		bne	.L58
 695 0108 D2E7     		b	.L50
 696              	.L64:
 697              	.LBE2:
 252:Src/mp3_player.c **** 		out_buf_offs = BUFFER_OFFSET_NONE;
 698              		.loc 1 252 0 is_stmt 1
 699 010a 0220     		movs	r0, #2
 700              	.LVL50:
 701 010c FFF7FEFF 		bl	BSP_AUDIO_OUT_Stop
 702              	.LVL51:
 253:Src/mp3_player.c **** 	}
 703              		.loc 1 253 0
 704 0110 114B     		ldr	r3, .L67+64
 705 0112 0022     		movs	r2, #0
 706 0114 1A70     		strb	r2, [r3]
 707 0116 84E7     		b	.L59
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 22


 708              	.L68:
 709              		.align	2
 710              	.L67:
 711 0118 00000000 		.word	.LC9
 712 011c 00000000 		.word	.LANCHOR4
 713 0120 1C000000 		.word	.LC10
 714 0124 00000000 		.word	state
 715 0128 00000000 		.word	.LANCHOR0
 716 012c 00000000 		.word	.LANCHOR1
 717 0130 64000000 		.word	.LC13
 718 0134 00000000 		.word	output_buffer
 719 0138 00000000 		.word	gui_info_text
 720 013c 40000000 		.word	.LC11
 721 0140 00000000 		.word	.LANCHOR8
 722 0144 48000000 		.word	.LC12
 723 0148 00000000 		.word	.LANCHOR9
 724 014c 00000000 		.word	paths
 725 0150 00000000 		.word	.LANCHOR2
 726 0154 00000000 		.word	.LANCHOR7
 727 0158 00000000 		.word	.LANCHOR5
 728              		.cfi_endproc
 729              	.LFE145:
 731              		.section	.text.BSP_AUDIO_OUT_TransferComplete_CallBack,"ax",%progbits
 732              		.align	1
 733              		.global	BSP_AUDIO_OUT_TransferComplete_CallBack
 734              		.syntax unified
 735              		.thumb
 736              		.thumb_func
 737              		.fpu fpv5-sp-d16
 739              	BSP_AUDIO_OUT_TransferComplete_CallBack:
 740              	.LFB147:
 342:Src/mp3_player.c ****     out_buf_offs = BUFFER_OFFSET_FULL;
 741              		.loc 1 342 0
 742              		.cfi_startproc
 743              		@ args = 0, pretend = 0, frame = 0
 744              		@ frame_needed = 0, uses_anonymous_args = 0
 745 0000 08B5     		push	{r3, lr}
 746              	.LCFI11:
 747              		.cfi_def_cfa_offset 8
 748              		.cfi_offset 3, -8
 749              		.cfi_offset 14, -4
 343:Src/mp3_player.c **** 
 750              		.loc 1 343 0
 751 0002 074B     		ldr	r3, .L73
 752 0004 0222     		movs	r2, #2
 753 0006 1A70     		strb	r2, [r3]
 345:Src/mp3_player.c **** 	{
 754              		.loc 1 345 0
 755 0008 FFF7FEFF 		bl	mp3_player_process_frame
 756              	.LVL52:
 757 000c 00B9     		cbnz	r0, .L72
 758              	.L69:
 350:Src/mp3_player.c **** 
 759              		.loc 1 350 0
 760 000e 08BD     		pop	{r3, pc}
 761              	.L72:
 347:Src/mp3_player.c **** 		state = NEXT;
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 23


 762              		.loc 1 347 0
 763 0010 0220     		movs	r0, #2
 764 0012 FFF7FEFF 		bl	BSP_AUDIO_OUT_Stop
 765              	.LVL53:
 348:Src/mp3_player.c **** 	}
 766              		.loc 1 348 0
 767 0016 034B     		ldr	r3, .L73+4
 768 0018 0322     		movs	r2, #3
 769 001a 1A70     		strb	r2, [r3]
 350:Src/mp3_player.c **** 
 770              		.loc 1 350 0
 771 001c F7E7     		b	.L69
 772              	.L74:
 773 001e 00BF     		.align	2
 774              	.L73:
 775 0020 00000000 		.word	.LANCHOR5
 776 0024 00000000 		.word	state
 777              		.cfi_endproc
 778              	.LFE147:
 780              		.section	.text.BSP_AUDIO_OUT_HalfTransfer_CallBack,"ax",%progbits
 781              		.align	1
 782              		.global	BSP_AUDIO_OUT_HalfTransfer_CallBack
 783              		.syntax unified
 784              		.thumb
 785              		.thumb_func
 786              		.fpu fpv5-sp-d16
 788              	BSP_AUDIO_OUT_HalfTransfer_CallBack:
 789              	.LFB148:
 354:Src/mp3_player.c ****     out_buf_offs = BUFFER_OFFSET_HALF;
 790              		.loc 1 354 0
 791              		.cfi_startproc
 792              		@ args = 0, pretend = 0, frame = 0
 793              		@ frame_needed = 0, uses_anonymous_args = 0
 794 0000 08B5     		push	{r3, lr}
 795              	.LCFI12:
 796              		.cfi_def_cfa_offset 8
 797              		.cfi_offset 3, -8
 798              		.cfi_offset 14, -4
 355:Src/mp3_player.c **** 
 799              		.loc 1 355 0
 800 0002 074B     		ldr	r3, .L79
 801 0004 0122     		movs	r2, #1
 802 0006 1A70     		strb	r2, [r3]
 357:Src/mp3_player.c **** 	{
 803              		.loc 1 357 0
 804 0008 FFF7FEFF 		bl	mp3_player_process_frame
 805              	.LVL54:
 806 000c 00B9     		cbnz	r0, .L78
 807              	.L75:
 362:Src/mp3_player.c **** 
 808              		.loc 1 362 0
 809 000e 08BD     		pop	{r3, pc}
 810              	.L78:
 359:Src/mp3_player.c **** 		state = NEXT;
 811              		.loc 1 359 0
 812 0010 0220     		movs	r0, #2
 813 0012 FFF7FEFF 		bl	BSP_AUDIO_OUT_Stop
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 24


 814              	.LVL55:
 360:Src/mp3_player.c **** 	}
 815              		.loc 1 360 0
 816 0016 034B     		ldr	r3, .L79+4
 817 0018 0322     		movs	r2, #3
 818 001a 1A70     		strb	r2, [r3]
 362:Src/mp3_player.c **** 
 819              		.loc 1 362 0
 820 001c F7E7     		b	.L75
 821              	.L80:
 822 001e 00BF     		.align	2
 823              	.L79:
 824 0020 00000000 		.word	.LANCHOR5
 825 0024 00000000 		.word	state
 826              		.cfi_endproc
 827              	.LFE148:
 829              		.section	.text.reset_player_state,"ax",%progbits
 830              		.align	1
 831              		.global	reset_player_state
 832              		.syntax unified
 833              		.thumb
 834              		.thumb_func
 835              		.fpu fpv5-sp-d16
 837              	reset_player_state:
 838              	.LFB151:
 401:Src/mp3_player.c **** 
 402:Src/mp3_player.c **** // reset all the used data structures
 403:Src/mp3_player.c **** void reset_player_state() 
 404:Src/mp3_player.c **** {
 839              		.loc 1 404 0
 840              		.cfi_startproc
 841              		@ args = 0, pretend = 0, frame = 0
 842              		@ frame_needed = 0, uses_anonymous_args = 0
 843              		@ link register save eliminated.
 405:Src/mp3_player.c **** 	buffer_leftover = 0;
 844              		.loc 1 405 0
 845 0000 0023     		movs	r3, #0
 846 0002 034A     		ldr	r2, .L82
 847 0004 1360     		str	r3, [r2]
 406:Src/mp3_player.c ****     current_ptr = NULL;
 848              		.loc 1 406 0
 849 0006 034A     		ldr	r2, .L82+4
 850 0008 1360     		str	r3, [r2]
 407:Src/mp3_player.c ****     out_buf_offs = BUFFER_OFFSET_NONE;
 851              		.loc 1 407 0
 852 000a 034A     		ldr	r2, .L82+8
 853 000c 1370     		strb	r3, [r2]
 408:Src/mp3_player.c **** }...
 854              		.loc 1 408 0
 855 000e 7047     		bx	lr
 856              	.L83:
 857              		.align	2
 858              	.L82:
 859 0010 00000000 		.word	.LANCHOR0
 860 0014 00000000 		.word	.LANCHOR1
 861 0018 00000000 		.word	.LANCHOR5
 862              		.cfi_endproc
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 25


 863              	.LFE151:
 865              		.section	.text.mp3_player_fsm,"ax",%progbits
 866              		.align	1
 867              		.global	mp3_player_fsm
 868              		.syntax unified
 869              		.thumb
 870              		.thumb_func
 871              		.fpu fpv5-sp-d16
 873              	mp3_player_fsm:
 874              	.LFB143:
  69:Src/mp3_player.c **** {
 875              		.loc 1 69 0
 876              		.cfi_startproc
 877              		@ args = 0, pretend = 0, frame = 336
 878              		@ frame_needed = 0, uses_anonymous_args = 0
 879              	.LVL56:
 880 0000 F0B5     		push	{r4, r5, r6, r7, lr}
 881              	.LCFI13:
 882              		.cfi_def_cfa_offset 20
 883              		.cfi_offset 4, -20
 884              		.cfi_offset 5, -16
 885              		.cfi_offset 6, -12
 886              		.cfi_offset 7, -8
 887              		.cfi_offset 14, -4
 888 0002 D5B0     		sub	sp, sp, #340
 889              	.LCFI14:
 890              		.cfi_def_cfa_offset 360
 891 0004 0646     		mov	r6, r0
  70:Src/mp3_player.c ****     BSP_init();
 892              		.loc 1 70 0
 893 0006 FFF7FEFF 		bl	BSP_init
 894              	.LVL57:
  71:Src/mp3_player.c ****     state = NEXT;
 895              		.loc 1 71 0
 896 000a 9B4B     		ldr	r3, .L127
 897 000c 0322     		movs	r2, #3
 898 000e 1A70     		strb	r2, [r3]
  73:Src/mp3_player.c ****     touchscreen_loop_init();
 899              		.loc 1 73 0
 900 0010 FFF7FEFF 		bl	touchscreen_loop_init
 901              	.LVL58:
  75:Src/mp3_player.c **** 	sprintf(gui_info_text, "Initializing...");
 902              		.loc 1 75 0
 903 0014 994D     		ldr	r5, .L127+4
 904 0016 9A4C     		ldr	r4, .L127+8
 905 0018 0FCC     		ldmia	r4!, {r0, r1, r2, r3}
 906 001a 2860     		str	r0, [r5]	@ unaligned
 907 001c 6960     		str	r1, [r5, #4]	@ unaligned
 908 001e AA60     		str	r2, [r5, #8]	@ unaligned
 909 0020 EB60     		str	r3, [r5, #12]	@ unaligned
  76:Src/mp3_player.c **** 	refresh_screen(gui_info_text);
 910              		.loc 1 76 0
 911 0022 2846     		mov	r0, r5
 912 0024 FFF7FEFF 		bl	refresh_screen
 913              	.LVL59:
  81:Src/mp3_player.c ****     if (f_opendir(&directory, path) != FR_OK) {
 914              		.loc 1 81 0
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 26


 915 0028 3146     		mov	r1, r6
 916 002a 46A8     		add	r0, sp, #280
 917 002c FFF7FEFF 		bl	f_opendir
 918              	.LVL60:
 919 0030 98B9     		cbnz	r0, .L117
 920              	.L89:
  87:Src/mp3_player.c ****         if (f_readdir(&directory, &info) != FR_OK) {
 921              		.loc 1 87 0
 922 0032 6946     		mov	r1, sp
 923 0034 46A8     		add	r0, sp, #280
 924 0036 FFF7FEFF 		bl	f_readdir
 925              	.LVL61:
 926 003a 90B9     		cbnz	r0, .L118
  91:Src/mp3_player.c ****         if (info.fname[0] == 0)
 927              		.loc 1 91 0
 928 003c 9DF81630 		ldrb	r3, [sp, #22]	@ zero_extendqisi2
 929 0040 A3B1     		cbz	r3, .L88
  93:Src/mp3_player.c ****         if (strstr(info.fname, ".mp3"))
 930              		.loc 1 93 0
 931 0042 9049     		ldr	r1, .L127+12
 932 0044 0DF11600 		add	r0, sp, #22
 933 0048 FFF7FEFF 		bl	strstr
 934              	.LVL62:
 935 004c 0028     		cmp	r0, #0
 936 004e F0D0     		beq	.L89
  94:Src/mp3_player.c ****             mp3FilesCounter++;
 937              		.loc 1 94 0
 938 0050 8D4A     		ldr	r2, .L127+16
 939 0052 1368     		ldr	r3, [r2]
 940 0054 0133     		adds	r3, r3, #1
 941 0056 1360     		str	r3, [r2]
 942 0058 EBE7     		b	.L89
 943              	.L117:
  82:Src/mp3_player.c ****         if (DEBUG_ON) xprintf("Error opening the directory\n");
 944              		.loc 1 82 0 discriminator 1
 945 005a 8C48     		ldr	r0, .L127+20
 946 005c FFF7FEFF 		bl	xprintf
 947              	.LVL63:
  83:Src/mp3_player.c ****         return;
 948              		.loc 1 83 0 discriminator 1
 949 0060 02E0     		b	.L84
 950              	.L118:
  88:Src/mp3_player.c ****             xprintf("Error reading from directory\n");
 951              		.loc 1 88 0
 952 0062 8B48     		ldr	r0, .L127+24
 953 0064 FFF7FEFF 		bl	xprintf
 954              	.LVL64:
 955              	.L84:
 200:Src/mp3_player.c **** }
 956              		.loc 1 200 0
 957 0068 55B0     		add	sp, sp, #340
 958              	.LCFI15:
 959              		.cfi_remember_state
 960              		.cfi_def_cfa_offset 20
 961              		@ sp needed
 962 006a F0BD     		pop	{r4, r5, r6, r7, pc}
 963              	.LVL65:
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 27


 964              	.L88:
 965              	.LCFI16:
 966              		.cfi_restore_state
  97:Src/mp3_player.c ****     f_closedir(&directory);
 967              		.loc 1 97 0
 968 006c 46A8     		add	r0, sp, #280
 969 006e FFF7FEFF 		bl	f_closedir
 970              	.LVL66:
 100:Src/mp3_player.c ****     paths = malloc(sizeof(char*) * mp3FilesCounter);
 971              		.loc 1 100 0
 972 0072 854B     		ldr	r3, .L127+16
 973 0074 1868     		ldr	r0, [r3]
 974 0076 8000     		lsls	r0, r0, #2
 975 0078 FFF7FEFF 		bl	malloc
 976              	.LVL67:
 977 007c 854B     		ldr	r3, .L127+28
 978 007e 1860     		str	r0, [r3]
 102:Src/mp3_player.c ****     if (paths == NULL) {
 979              		.loc 1 102 0
 980 0080 70B3     		cbz	r0, .L119
 107:Src/mp3_player.c ****     if (f_opendir(&directory, path) != FR_OK) {
 981              		.loc 1 107 0
 982 0082 3146     		mov	r1, r6
 983 0084 46A8     		add	r0, sp, #280
 984 0086 FFF7FEFF 		bl	f_opendir
 985              	.LVL68:
 986 008a 68BB     		cbnz	r0, .L120
  99:Src/mp3_player.c ****     int i = 0;
 987              		.loc 1 99 0
 988 008c 0024     		movs	r4, #0
 989              	.LVL69:
 990              	.L94:
 113:Src/mp3_player.c ****         if (f_readdir(&directory, &info) != FR_OK) {
 991              		.loc 1 113 0
 992 008e 6946     		mov	r1, sp
 993 0090 46A8     		add	r0, sp, #280
 994 0092 FFF7FEFF 		bl	f_readdir
 995              	.LVL70:
 996 0096 58BB     		cbnz	r0, .L121
 117:Src/mp3_player.c ****         if (info.fname[0] == 0)
 997              		.loc 1 117 0
 998 0098 9DF81630 		ldrb	r3, [sp, #22]	@ zero_extendqisi2
 999 009c 63B3     		cbz	r3, .L93
 119:Src/mp3_player.c ****         if (strstr(info.fname, ".mp3")) {
 1000              		.loc 1 119 0
 1001 009e 7949     		ldr	r1, .L127+12
 1002 00a0 0DF11600 		add	r0, sp, #22
 1003 00a4 FFF7FEFF 		bl	strstr
 1004              	.LVL71:
 1005 00a8 0028     		cmp	r0, #0
 1006 00aa F0D0     		beq	.L94
 120:Src/mp3_player.c ****             paths[i] = malloc((strlen(info.fname) + 1) * sizeof(char));
 1007              		.loc 1 120 0
 1008 00ac 0DF11600 		add	r0, sp, #22
 1009 00b0 FFF7FEFF 		bl	strlen
 1010              	.LVL72:
 1011 00b4 774D     		ldr	r5, .L127+28
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 28


 1012 00b6 2F68     		ldr	r7, [r5]
 1013 00b8 0130     		adds	r0, r0, #1
 1014 00ba FFF7FEFF 		bl	malloc
 1015              	.LVL73:
 1016 00be 47F82400 		str	r0, [r7, r4, lsl #2]
 121:Src/mp3_player.c **** 			strcpy(paths[i], info.fname);
 1017              		.loc 1 121 0
 1018 00c2 2B68     		ldr	r3, [r5]
 1019 00c4 0DF11601 		add	r1, sp, #22
 1020 00c8 53F82400 		ldr	r0, [r3, r4, lsl #2]
 1021 00cc FFF7FEFF 		bl	strcpy
 1022              	.LVL74:
 122:Src/mp3_player.c **** 			if(DEBUG_ON) xprintf("%s\n", paths[i]);
 1023              		.loc 1 122 0
 1024 00d0 2B68     		ldr	r3, [r5]
 1025 00d2 53F82410 		ldr	r1, [r3, r4, lsl #2]
 1026 00d6 7048     		ldr	r0, .L127+32
 1027 00d8 FFF7FEFF 		bl	xprintf
 1028              	.LVL75:
 123:Src/mp3_player.c ****             i++;
 1029              		.loc 1 123 0
 1030 00dc 0134     		adds	r4, r4, #1
 1031              	.LVL76:
 1032 00de D6E7     		b	.L94
 1033              	.LVL77:
 1034              	.L119:
 103:Src/mp3_player.c ****         if (DEBUG_ON) xprintf("Error allocating memory\n");
 1035              		.loc 1 103 0 discriminator 1
 1036 00e0 6E48     		ldr	r0, .L127+36
 1037 00e2 FFF7FEFF 		bl	xprintf
 1038              	.LVL78:
 104:Src/mp3_player.c ****         return;
 1039              		.loc 1 104 0 discriminator 1
 1040 00e6 BFE7     		b	.L84
 1041              	.L120:
 108:Src/mp3_player.c ****         if (DEBUG_ON) xprintf("Error opening the directory\n");
 1042              		.loc 1 108 0 discriminator 1
 1043 00e8 6848     		ldr	r0, .L127+20
 1044 00ea FFF7FEFF 		bl	xprintf
 1045              	.LVL79:
 109:Src/mp3_player.c ****         return;
 1046              		.loc 1 109 0 discriminator 1
 1047 00ee BBE7     		b	.L84
 1048              	.LVL80:
 1049              	.L121:
 114:Src/mp3_player.c ****             xprintf("Error reading from directory\n");
 1050              		.loc 1 114 0
 1051 00f0 6748     		ldr	r0, .L127+24
 1052 00f2 FFF7FEFF 		bl	xprintf
 1053              	.LVL81:
 115:Src/mp3_player.c ****             return;
 1054              		.loc 1 115 0
 1055 00f6 B7E7     		b	.L84
 1056              	.L93:
 127:Src/mp3_player.c **** 	f_closedir(&directory);
 1057              		.loc 1 127 0
 1058 00f8 46A8     		add	r0, sp, #280
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 29


 1059 00fa FFF7FEFF 		bl	f_closedir
 1060              	.LVL82:
 1061              	.L96:
 131:Src/mp3_player.c **** 		switch(state)
 1062              		.loc 1 131 0
 1063 00fe 5E4B     		ldr	r3, .L127
 1064 0100 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1065 0102 052B     		cmp	r3, #5
 1066 0104 00F2B380 		bhi	.L97
 1067 0108 01A2     		adr	r2, .L99
 1068 010a 52F823F0 		ldr	pc, [r2, r3, lsl #2]
 1069 010e 00BF     		.p2align 2
 1070              	.L99:
 1071 0110 29010000 		.word	.L98+1
 1072 0114 FF000000 		.word	.L96+1
 1073 0118 0F020000 		.word	.L100+1
 1074 011c 87010000 		.word	.L101+1
 1075 0120 CD010000 		.word	.L102+1
 1076 0124 67020000 		.word	.L103+1
 1077              		.p2align 1
 1078              	.L98:
 134:Src/mp3_player.c **** 			    if(DEBUG_ON) xprintf("Now playing\n");
 1079              		.loc 1 134 0 discriminator 1
 1080 0128 5D48     		ldr	r0, .L127+40
 1081 012a FFF7FEFF 		bl	xprintf
 1082              	.LVL83:
 135:Src/mp3_player.c **** 				if (f_findfirst(&directory, &info, path, paths[currentFilePosition]) != FR_OK) {
 1083              		.loc 1 135 0 discriminator 1
 1084 012e 5D4B     		ldr	r3, .L127+44
 1085 0130 1A68     		ldr	r2, [r3]
 1086 0132 584B     		ldr	r3, .L127+28
 1087 0134 1B68     		ldr	r3, [r3]
 1088 0136 53F82230 		ldr	r3, [r3, r2, lsl #2]
 1089 013a 3246     		mov	r2, r6
 1090 013c 6946     		mov	r1, sp
 1091 013e 46A8     		add	r0, sp, #280
 1092 0140 FFF7FEFF 		bl	f_findfirst
 1093              	.LVL84:
 1094 0144 D8B9     		cbnz	r0, .L122
 139:Src/mp3_player.c **** 				currentFileBytes = info.fsize;
 1095              		.loc 1 139 0
 1096 0146 009A     		ldr	r2, [sp]
 1097 0148 574B     		ldr	r3, .L127+48
 1098 014a 1A60     		str	r2, [r3]
 140:Src/mp3_player.c **** 				f_closedir(&directory);
 1099              		.loc 1 140 0
 1100 014c 46A8     		add	r0, sp, #280
 1101 014e FFF7FEFF 		bl	f_closedir
 1102              	.LVL85:
 141:Src/mp3_player.c **** 				sprintf(gui_info_text, "%s", paths[currentFilePosition]);
 1103              		.loc 1 141 0
 1104 0152 544B     		ldr	r3, .L127+44
 1105 0154 1A68     		ldr	r2, [r3]
 1106 0156 4F4B     		ldr	r3, .L127+28
 1107 0158 1B68     		ldr	r3, [r3]
 1108 015a 484C     		ldr	r4, .L127+4
 1109 015c 53F82210 		ldr	r1, [r3, r2, lsl #2]
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 30


 1110 0160 2046     		mov	r0, r4
 1111 0162 FFF7FEFF 		bl	strcpy
 1112              	.LVL86:
 142:Src/mp3_player.c **** 				refresh_screen(gui_info_text);
 1113              		.loc 1 142 0
 1114 0166 2046     		mov	r0, r4
 1115 0168 FFF7FEFF 		bl	refresh_screen
 1116              	.LVL87:
 143:Src/mp3_player.c **** 				mp3_player_play();
 1117              		.loc 1 143 0
 1118 016c FFF7FEFF 		bl	mp3_player_play
 1119              	.LVL88:
 144:Src/mp3_player.c ****                 f_close(&input_file);
 1120              		.loc 1 144 0
 1121 0170 4E48     		ldr	r0, .L127+52
 1122 0172 FFF7FEFF 		bl	f_close
 1123              	.LVL89:
 145:Src/mp3_player.c **** 				currentFileBytesRead = 0;
 1124              		.loc 1 145 0
 1125 0176 4E4B     		ldr	r3, .L127+56
 1126 0178 0022     		movs	r2, #0
 1127 017a 1A60     		str	r2, [r3]
 146:Src/mp3_player.c **** 				break;
 1128              		.loc 1 146 0
 1129 017c BFE7     		b	.L96
 1130              	.L122:
 136:Src/mp3_player.c ****             		xprintf("Error looking for first file occurence\n");
 1131              		.loc 1 136 0
 1132 017e 4D48     		ldr	r0, .L127+60
 1133 0180 FFF7FEFF 		bl	xprintf
 1134              	.LVL90:
 137:Src/mp3_player.c ****             		return;
 1135              		.loc 1 137 0
 1136 0184 70E7     		b	.L84
 1137              	.L101:
 148:Src/mp3_player.c **** 			    reset_player_state();
 1138              		.loc 1 148 0
 1139 0186 FFF7FEFF 		bl	reset_player_state
 1140              	.LVL91:
 149:Src/mp3_player.c **** 			    if (currentFilePosition == mp3FilesCounter - 1)
 1141              		.loc 1 149 0
 1142 018a 3F4B     		ldr	r3, .L127+16
 1143 018c 1B68     		ldr	r3, [r3]
 1144 018e 013B     		subs	r3, r3, #1
 1145 0190 444A     		ldr	r2, .L127+44
 1146 0192 1268     		ldr	r2, [r2]
 1147 0194 9342     		cmp	r3, r2
 1148 0196 11D0     		beq	.L123
 152:Src/mp3_player.c ****                     currentFilePosition++;
 1149              		.loc 1 152 0
 1150 0198 0132     		adds	r2, r2, #1
 1151 019a 424B     		ldr	r3, .L127+44
 1152 019c 1A60     		str	r2, [r3]
 1153              	.L107:
 153:Src/mp3_player.c ****                 if (f_open(&input_file, paths[currentFilePosition], FA_READ) != FR_OK) {
 1154              		.loc 1 153 0
 1155 019e 414B     		ldr	r3, .L127+44
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 31


 1156 01a0 1968     		ldr	r1, [r3]
 1157 01a2 3C4B     		ldr	r3, .L127+28
 1158 01a4 1B68     		ldr	r3, [r3]
 1159 01a6 0122     		movs	r2, #1
 1160 01a8 53F82110 		ldr	r1, [r3, r1, lsl #2]
 1161 01ac 3F48     		ldr	r0, .L127+52
 1162 01ae FFF7FEFF 		bl	f_open
 1163              	.LVL92:
 1164 01b2 38B9     		cbnz	r0, .L124
 157:Src/mp3_player.c ****                 state = PLAY;
 1165              		.loc 1 157 0
 1166 01b4 304B     		ldr	r3, .L127
 1167 01b6 0022     		movs	r2, #0
 1168 01b8 1A70     		strb	r2, [r3]
 158:Src/mp3_player.c **** 				break;
 1169              		.loc 1 158 0
 1170 01ba A0E7     		b	.L96
 1171              	.L123:
 150:Src/mp3_player.c ****                     currentFilePosition = 0;
 1172              		.loc 1 150 0
 1173 01bc 394B     		ldr	r3, .L127+44
 1174 01be 0022     		movs	r2, #0
 1175 01c0 1A60     		str	r2, [r3]
 1176 01c2 ECE7     		b	.L107
 1177              	.L124:
 154:Src/mp3_player.c ****                     if(DEBUG_ON) xprintf("Error opening file\n");
 1178              		.loc 1 154 0 discriminator 1
 1179 01c4 3C48     		ldr	r0, .L127+64
 1180 01c6 FFF7FEFF 		bl	xprintf
 1181              	.LVL93:
 155:Src/mp3_player.c ****                     return;
 1182              		.loc 1 155 0 discriminator 1
 1183 01ca 4DE7     		b	.L84
 1184              	.L102:
 160:Src/mp3_player.c ****                 reset_player_state();
 1185              		.loc 1 160 0
 1186 01cc FFF7FEFF 		bl	reset_player_state
 1187              	.LVL94:
 161:Src/mp3_player.c ****                 if (currentFilePosition == 0)
 1188              		.loc 1 161 0
 1189 01d0 344B     		ldr	r3, .L127+44
 1190 01d2 1B68     		ldr	r3, [r3]
 1191 01d4 9BB9     		cbnz	r3, .L109
 162:Src/mp3_player.c ****                     currentFilePosition = mp3FilesCounter - 1;
 1192              		.loc 1 162 0
 1193 01d6 2C4B     		ldr	r3, .L127+16
 1194 01d8 1B68     		ldr	r3, [r3]
 1195 01da 013B     		subs	r3, r3, #1
 1196 01dc 314A     		ldr	r2, .L127+44
 1197 01de 1360     		str	r3, [r2]
 1198              	.L110:
 165:Src/mp3_player.c ****                 if (f_open(&input_file, paths[currentFilePosition], FA_READ) != FR_OK) {
 1199              		.loc 1 165 0
 1200 01e0 304B     		ldr	r3, .L127+44
 1201 01e2 1968     		ldr	r1, [r3]
 1202 01e4 2B4B     		ldr	r3, .L127+28
 1203 01e6 1B68     		ldr	r3, [r3]
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 32


 1204 01e8 0122     		movs	r2, #1
 1205 01ea 53F82110 		ldr	r1, [r3, r1, lsl #2]
 1206 01ee 2F48     		ldr	r0, .L127+52
 1207 01f0 FFF7FEFF 		bl	f_open
 1208              	.LVL95:
 1209 01f4 38B9     		cbnz	r0, .L125
 169:Src/mp3_player.c ****                 state = PLAY;
 1210              		.loc 1 169 0
 1211 01f6 204B     		ldr	r3, .L127
 1212 01f8 0022     		movs	r2, #0
 1213 01fa 1A70     		strb	r2, [r3]
 170:Src/mp3_player.c ****                 break;
 1214              		.loc 1 170 0
 1215 01fc 7FE7     		b	.L96
 1216              	.L109:
 164:Src/mp3_player.c ****                     currentFilePosition--;
 1217              		.loc 1 164 0
 1218 01fe 013B     		subs	r3, r3, #1
 1219 0200 284A     		ldr	r2, .L127+44
 1220 0202 1360     		str	r3, [r2]
 1221 0204 ECE7     		b	.L110
 1222              	.L125:
 166:Src/mp3_player.c ****                     if(DEBUG_ON) xprintf("Error opening file\n");
 1223              		.loc 1 166 0 discriminator 1
 1224 0206 2C48     		ldr	r0, .L127+64
 1225 0208 FFF7FEFF 		bl	xprintf
 1226              	.LVL96:
 167:Src/mp3_player.c ****                     return;
 1227              		.loc 1 167 0 discriminator 1
 1228 020c 2CE7     		b	.L84
 1229              	.L100:
 175:Src/mp3_player.c ****                 reset_player_state();
 1230              		.loc 1 175 0
 1231 020e FFF7FEFF 		bl	reset_player_state
 1232              	.LVL97:
 176:Src/mp3_player.c ****                 currentFilePosition = 0;
 1233              		.loc 1 176 0
 1234 0212 244B     		ldr	r3, .L127+44
 1235 0214 0022     		movs	r2, #0
 1236 0216 1A60     		str	r2, [r3]
 177:Src/mp3_player.c **** 				sprintf(gui_info_text, "STOPPED");
 1237              		.loc 1 177 0
 1238 0218 184A     		ldr	r2, .L127+4
 1239 021a 284B     		ldr	r3, .L127+68
 1240 021c 03CB     		ldmia	r3!, {r0, r1}
 1241 021e 1060     		str	r0, [r2]	@ unaligned
 1242 0220 5160     		str	r1, [r2, #4]	@ unaligned
 178:Src/mp3_player.c **** 				refresh_screen(gui_info_text);
 1243              		.loc 1 178 0
 1244 0222 1046     		mov	r0, r2
 1245 0224 FFF7FEFF 		bl	refresh_screen
 1246              	.LVL98:
 1247              	.L113:
 179:Src/mp3_player.c ****                 while(state == STOP) {
 1248              		.loc 1 179 0
 1249 0228 134B     		ldr	r3, .L127
 1250 022a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 33


 1251 022c 022B     		cmp	r3, #2
 1252 022e 06D1     		bne	.L126
 1253              	.LBB3:
 180:Src/mp3_player.c ****                     Mp3_Player_State newState = check_touchscreen();
 1254              		.loc 1 180 0
 1255 0230 FFF7FEFF 		bl	check_touchscreen
 1256              	.LVL99:
 181:Src/mp3_player.c ****                     if (newState != EMPTY)
 1257              		.loc 1 181 0
 1258 0234 0628     		cmp	r0, #6
 1259 0236 F7D0     		beq	.L113
 182:Src/mp3_player.c ****                         state = newState;
 1260              		.loc 1 182 0
 1261 0238 0F4B     		ldr	r3, .L127
 1262 023a 1870     		strb	r0, [r3]
 1263 023c F4E7     		b	.L113
 1264              	.LVL100:
 1265              	.L126:
 1266              	.LBE3:
 184:Src/mp3_player.c ****                 if (state == PLAY)
 1267              		.loc 1 184 0
 1268 023e 002B     		cmp	r3, #0
 1269 0240 7FF45DAF 		bne	.L96
 185:Src/mp3_player.c ****                     if (f_open(&input_file, paths[currentFilePosition], FA_READ) != FR_OK) {
 1270              		.loc 1 185 0
 1271 0244 174B     		ldr	r3, .L127+44
 1272 0246 1968     		ldr	r1, [r3]
 1273 0248 124B     		ldr	r3, .L127+28
 1274 024a 1B68     		ldr	r3, [r3]
 1275 024c 0122     		movs	r2, #1
 1276 024e 53F82110 		ldr	r1, [r3, r1, lsl #2]
 1277 0252 1648     		ldr	r0, .L127+52
 1278 0254 FFF7FEFF 		bl	f_open
 1279              	.LVL101:
 1280 0258 0028     		cmp	r0, #0
 1281 025a 3FF450AF 		beq	.L96
 186:Src/mp3_player.c ****                         if(DEBUG_ON) xprintf("Error opening file\n");
 1282              		.loc 1 186 0 discriminator 1
 1283 025e 1648     		ldr	r0, .L127+64
 1284 0260 FFF7FEFF 		bl	xprintf
 1285              	.LVL102:
 187:Src/mp3_player.c ****                         return;
 1286              		.loc 1 187 0 discriminator 1
 1287 0264 00E7     		b	.L84
 1288              	.L103:
 191:Src/mp3_player.c **** 			    if(DEBUG_ON) xprintf("fsm: state -> finish\n");
 1289              		.loc 1 191 0 discriminator 1
 1290 0266 1648     		ldr	r0, .L127+72
 1291 0268 FFF7FEFF 		bl	xprintf
 1292              	.LVL103:
 192:Src/mp3_player.c **** 				return;
 1293              		.loc 1 192 0 discriminator 1
 1294 026c FCE6     		b	.L84
 1295              	.L97:
 194:Src/mp3_player.c ****                 if(DEBUG_ON) xprintf("fsm: state -> default\n");
 1296              		.loc 1 194 0 discriminator 1
 1297 026e 1548     		ldr	r0, .L127+76
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 34


 1298 0270 FFF7FEFF 		bl	xprintf
 1299              	.LVL104:
 195:Src/mp3_player.c ****                 return;
 1300              		.loc 1 195 0 discriminator 1
 1301 0274 F8E6     		b	.L84
 1302              	.L128:
 1303 0276 00BF     		.align	2
 1304              	.L127:
 1305 0278 00000000 		.word	state
 1306 027c 00000000 		.word	gui_info_text
 1307 0280 00000000 		.word	.LC14
 1308 0284 50000000 		.word	.LC17
 1309 0288 00000000 		.word	.LANCHOR10
 1310 028c 10000000 		.word	.LC15
 1311 0290 30000000 		.word	.LC16
 1312 0294 00000000 		.word	paths
 1313 0298 74000000 		.word	.LC19
 1314 029c 58000000 		.word	.LC18
 1315 02a0 78000000 		.word	.LC20
 1316 02a4 00000000 		.word	.LANCHOR9
 1317 02a8 00000000 		.word	.LANCHOR7
 1318 02ac 00000000 		.word	input_file
 1319 02b0 00000000 		.word	.LANCHOR2
 1320 02b4 88000000 		.word	.LC21
 1321 02b8 B0000000 		.word	.LC22
 1322 02bc C4000000 		.word	.LC23
 1323 02c0 CC000000 		.word	.LC24
 1324 02c4 E4000000 		.word	.LC25
 1325              		.cfi_endproc
 1326              	.LFE143:
 1328              		.comm	gui_info_text,100,4
 1329              		.global	has_been_paused
 1330              		.global	currentFileBytesRead
 1331              		.global	currentFileBytes
 1332              		.global	currentFilePosition
 1333              		.global	mp3FilesCounter
 1334              		.comm	paths,4,4
 1335              		.comm	input_file,560,4
 1336              		.comm	input_buffer,3880,4
 1337              		.comm	output_buffer,9216,4
 1338              		.comm	state,1,1
 1339              		.section	.bss.buffer_leftover,"aw",%nobits
 1340              		.align	2
 1341              		.set	.LANCHOR0,. + 0
 1344              	buffer_leftover:
 1345 0000 00000000 		.space	4
 1346              		.section	.bss.currentFileBytes,"aw",%nobits
 1347              		.align	2
 1348              		.set	.LANCHOR7,. + 0
 1351              	currentFileBytes:
 1352 0000 00000000 		.space	4
 1353              		.section	.bss.currentFileBytesRead,"aw",%nobits
 1354              		.align	2
 1355              		.set	.LANCHOR2,. + 0
 1358              	currentFileBytesRead:
 1359 0000 00000000 		.space	4
 1360              		.section	.bss.current_ptr,"aw",%nobits
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 35


 1361              		.align	2
 1362              		.set	.LANCHOR1,. + 0
 1365              	current_ptr:
 1366 0000 00000000 		.space	4
 1367              		.section	.bss.decode_result,"aw",%nobits
 1368              		.align	2
 1369              		.set	.LANCHOR6,. + 0
 1372              	decode_result:
 1373 0000 00000000 		.space	4
 1374              		.section	.bss.hMP3Decoder,"aw",%nobits
 1375              		.align	2
 1376              		.set	.LANCHOR4,. + 0
 1379              	hMP3Decoder:
 1380 0000 00000000 		.space	4
 1381              		.section	.bss.has_been_paused,"aw",%nobits
 1382              		.align	2
 1383              		.set	.LANCHOR8,. + 0
 1386              	has_been_paused:
 1387 0000 00000000 		.space	4
 1388              		.section	.bss.in_buf_offs,"aw",%nobits
 1389              		.align	2
 1390              		.set	.LANCHOR3,. + 0
 1393              	in_buf_offs:
 1394 0000 00000000 		.space	4
 1395              		.section	.bss.mp3FilesCounter,"aw",%nobits
 1396              		.align	2
 1397              		.set	.LANCHOR10,. + 0
 1400              	mp3FilesCounter:
 1401 0000 00000000 		.space	4
 1402              		.section	.bss.out_buf_offs,"aw",%nobits
 1403              		.set	.LANCHOR5,. + 0
 1406              	out_buf_offs:
 1407 0000 00       		.space	1
 1408              		.section	.data.currentFilePosition,"aw",%progbits
 1409              		.align	2
 1410              		.set	.LANCHOR9,. + 0
 1413              	currentFilePosition:
 1414 0000 FFFFFFFF 		.word	-1
 1415              		.section	.rodata.BSP_init.str1.4,"aMS",%progbits,1
 1416              		.align	2
 1417              	.LC0:
 1418 0000 41756469 		.ascii	"Audio Init Ok\012\000"
 1418      6F20496E 
 1418      6974204F 
 1418      6B0A00
 1419 000f 00       		.space	1
 1420              	.LC1:
 1421 0010 41756469 		.ascii	"Audio Init Error\012\000"
 1421      6F20496E 
 1421      69742045 
 1421      72726F72 
 1421      0A00
 1422              		.section	.rodata.fill_input_buffer.str1.4,"aMS",%progbits,1
 1423              		.align	2
 1424              	.LC2:
 1425 0000 66696C6C 		.ascii	"fill: copied from current_ptr input_buffer\012\000"
 1425      3A20636F 
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 36


 1425      70696564 
 1425      2066726F 
 1425      6D206375 
 1426              	.LC3:
 1427 002c 66696C6C 		.ascii	"fill: copied from file to input_buffer\012\000"
 1427      3A20636F 
 1427      70696564 
 1427      2066726F 
 1427      6D206669 
 1428              		.section	.rodata.mp3_player_fsm.str1.4,"aMS",%progbits,1
 1429              		.align	2
 1430              	.LC14:
 1431 0000 496E6974 		.ascii	"Initializing...\000"
 1431      69616C69 
 1431      7A696E67 
 1431      2E2E2E00 
 1432              	.LC15:
 1433 0010 4572726F 		.ascii	"Error opening the directory\012\000"
 1433      72206F70 
 1433      656E696E 
 1433      67207468 
 1433      65206469 
 1434 002d 000000   		.space	3
 1435              	.LC16:
 1436 0030 4572726F 		.ascii	"Error reading from directory\012\000"
 1436      72207265 
 1436      6164696E 
 1436      67206672 
 1436      6F6D2064 
 1437 004e 0000     		.space	2
 1438              	.LC17:
 1439 0050 2E6D7033 		.ascii	".mp3\000"
 1439      00
 1440 0055 000000   		.space	3
 1441              	.LC18:
 1442 0058 4572726F 		.ascii	"Error allocating memory\012\000"
 1442      7220616C 
 1442      6C6F6361 
 1442      74696E67 
 1442      206D656D 
 1443 0071 000000   		.space	3
 1444              	.LC19:
 1445 0074 25730A00 		.ascii	"%s\012\000"
 1446              	.LC20:
 1447 0078 4E6F7720 		.ascii	"Now playing\012\000"
 1447      706C6179 
 1447      696E670A 
 1447      00
 1448 0085 000000   		.space	3
 1449              	.LC21:
 1450 0088 4572726F 		.ascii	"Error looking for first file occurence\012\000"
 1450      72206C6F 
 1450      6F6B696E 
 1450      6720666F 
 1450      72206669 
 1451              	.LC22:
 1452 00b0 4572726F 		.ascii	"Error opening file\012\000"
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 37


 1452      72206F70 
 1452      656E696E 
 1452      67206669 
 1452      6C650A00 
 1453              	.LC23:
 1454 00c4 53544F50 		.ascii	"STOPPED\000"
 1454      50454400 
 1455              	.LC24:
 1456 00cc 66736D3A 		.ascii	"fsm: state -> finish\012\000"
 1456      20737461 
 1456      7465202D 
 1456      3E206669 
 1456      6E697368 
 1457 00e2 0000     		.space	2
 1458              	.LC25:
 1459 00e4 66736D3A 		.ascii	"fsm: state -> default\012\000"
 1459      20737461 
 1459      7465202D 
 1459      3E206465 
 1459      6661756C 
 1460              		.section	.rodata.mp3_player_play.str1.4,"aMS",%progbits,1
 1461              		.align	2
 1462              	.LC9:
 1463 0000 706C6179 		.ascii	"play: initializing decoder\012\000"
 1463      3A20696E 
 1463      69746961 
 1463      6C697A69 
 1463      6E672064 
 1464              	.LC10:
 1465 001c 706C6179 		.ascii	"play: starting frame processing\012\000"
 1465      3A207374 
 1465      61727469 
 1465      6E672066 
 1465      72616D65 
 1466 003d 000000   		.space	3
 1467              	.LC11:
 1468 0040 50415553 		.ascii	"PAUSED\000"
 1468      454400
 1469 0047 00       		.space	1
 1470              	.LC12:
 1471 0048 4572726F 		.ascii	"Error while pausing stream\012\000"
 1471      72207768 
 1471      696C6520 
 1471      70617573 
 1471      696E6720 
 1472              	.LC13:
 1473 0064 706C6179 		.ascii	"play: freeing decoder\012\000"
 1473      3A206672 
 1473      6565696E 
 1473      67206465 
 1473      636F6465 
 1474              		.section	.rodata.mp3_player_process_frame.str1.4,"aMS",%progbits,1
 1475              		.align	2
 1476              	.LC4:
 1477 0000 70726F63 		.ascii	"process: starting\012\000"
 1477      6573733A 
 1477      20737461 
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 38


 1477      7274696E 
 1477      670A00
 1478 0013 00       		.space	1
 1479              	.LC5:
 1480 0014 70726F63 		.ascii	"process: findSyncWord read\012\000"
 1480      6573733A 
 1480      2066696E 
 1480      6453796E 
 1480      63576F72 
 1481              	.LC6:
 1482 0030 70726F63 		.ascii	"process: out_buf half\012\000"
 1482      6573733A 
 1482      206F7574 
 1482      5F627566 
 1482      2068616C 
 1483 0047 00       		.space	1
 1484              	.LC7:
 1485 0048 70726F63 		.ascii	"process: out_buf full\012\000"
 1485      6573733A 
 1485      206F7574 
 1485      5F627566 
 1485      2066756C 
 1486 005f 00       		.space	1
 1487              	.LC8:
 1488 0060 416E2075 		.ascii	"An unkown error has occured while decoding the fram"
 1488      6E6B6F77 
 1488      6E206572 
 1488      726F7220 
 1488      68617320 
 1489 0093 650A00   		.ascii	"e\012\000"
 1490              		.text
 1491              	.Letext0:
 1492              		.file 2 "c:\\program files (x86)\\gnu\\7_2018-q2-update\\arm-none-eabi\\include\\machine\\_default
 1493              		.file 3 "c:\\program files (x86)\\gnu\\7_2018-q2-update\\arm-none-eabi\\include\\sys\\lock.h"
 1494              		.file 4 "c:\\program files (x86)\\gnu\\7_2018-q2-update\\arm-none-eabi\\include\\sys\\_types.h"
 1495              		.file 5 "c:\\program files (x86)\\gnu\\7_2018-q2-update\\lib\\gcc\\arm-none-eabi\\7.3.1\\include\\
 1496              		.file 6 "c:\\program files (x86)\\gnu\\7_2018-q2-update\\arm-none-eabi\\include\\sys\\reent.h"
 1497              		.file 7 "c:\\program files (x86)\\gnu\\7_2018-q2-update\\arm-none-eabi\\include\\sys\\_stdint.h"
 1498              		.file 8 "c:\\program files (x86)\\gnu\\7_2018-q2-update\\arm-none-eabi\\include\\stdlib.h"
 1499              		.file 9 "Inc/mp3_player.h"
 1500              		.file 10 "./lib\\helix\\pub\\mp3dec.h"
 1501              		.file 11 "Middlewares/Third_Party/FatFs/src/integer.h"
 1502              		.file 12 "Drivers/CMSIS/Include/core_cm7.h"
 1503              		.file 13 "Drivers/CMSIS/Device/ST/STM32F7xx/Include/system_stm32f7xx.h"
 1504              		.file 14 "Middlewares/Third_Party/FreeRTOS/Source/include/task.h"
 1505              		.file 15 "Middlewares/Third_Party/FreeRTOS/Source/include/queue.h"
 1506              		.file 16 "Middlewares/Third_Party/FreeRTOS/Source/include/semphr.h"
 1507              		.file 17 "Middlewares/Third_Party/FreeRTOS/Source/CMSIS_RTOS/cmsis_os.h"
 1508              		.file 18 "Middlewares/ST/STM32_USB_Host_Library/Core/Inc/usbh_def.h"
 1509              		.file 19 "Middlewares/ST/STM32_USB_Host_Library/Core/Inc/usbh_ctlreq.h"
 1510              		.file 20 "Middlewares/ST/STM32_USB_Host_Library/Class/MSC/Inc/usbh_msc.h"
 1511              		.file 21 "Middlewares/Third_Party/FatFs/src/ff.h"
 1512              		.file 22 "Middlewares/Third_Party/FatFs/src/diskio.h"
 1513              		.file 23 "Middlewares/Third_Party/FatFs/src/ff_gen_drv.h"
 1514              		.file 24 "Inc/sd_diskio.h"
 1515              		.file 25 "Inc/usbh_diskio.h"
 1516              		.file 26 "Inc/fatfs.h"
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 39


 1517              		.file 27 "Drivers/BSP/STM32746G-Discovery/../Components/wm8994/../Common/audio.h"
 1518              		.file 28 "Drivers/BSP/STM32746G-Discovery/../Components/wm8994/wm8994.h"
 1519              		.file 29 "Drivers/BSP/STM32746G-Discovery/stm32746g_discovery_audio.h"
 1520              		.file 30 "Inc/term_io.h"
 1521              		.file 31 "Inc/gui.h"
 1522              		.file 32 "<built-in>"
 1523              		.file 33 "c:\\program files (x86)\\gnu\\7_2018-q2-update\\arm-none-eabi\\include\\string.h"
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 40


DEFINED SYMBOLS
                            *ABS*:00000000 mp3_player.c
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:18     .text.BSP_init:00000000 $t
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:25     .text.BSP_init:00000000 BSP_init
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:64     .text.BSP_init:00000028 $d
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:70     .text.copy_leftover:00000000 $t
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:77     .text.copy_leftover:00000000 copy_leftover
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:105    .text.copy_leftover:00000018 $d
                            *COM*:00000f28 input_buffer
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:112    .text.fill_input_buffer:00000000 $t
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:119    .text.fill_input_buffer:00000000 fill_input_buffer
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:198    .text.fill_input_buffer:0000005c $d
                            *COM*:00000230 input_file
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:210    .text.mp3_player_process_frame:00000000 $t
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:217    .text.mp3_player_process_frame:00000000 mp3_player_process_frame
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:473    .text.mp3_player_process_frame:00000164 $d
                            *COM*:00002400 output_buffer
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:493    .text.mp3_player_play:00000000 $t
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:500    .text.mp3_player_play:00000000 mp3_player_play
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:711    .text.mp3_player_play:00000118 $d
                            *COM*:00000001 state
                            *COM*:00000064 gui_info_text
                            *COM*:00000004 paths
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:732    .text.BSP_AUDIO_OUT_TransferComplete_CallBack:00000000 $t
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:739    .text.BSP_AUDIO_OUT_TransferComplete_CallBack:00000000 BSP_AUDIO_OUT_TransferComplete_CallBack
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:775    .text.BSP_AUDIO_OUT_TransferComplete_CallBack:00000020 $d
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:781    .text.BSP_AUDIO_OUT_HalfTransfer_CallBack:00000000 $t
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:788    .text.BSP_AUDIO_OUT_HalfTransfer_CallBack:00000000 BSP_AUDIO_OUT_HalfTransfer_CallBack
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:824    .text.BSP_AUDIO_OUT_HalfTransfer_CallBack:00000020 $d
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:830    .text.reset_player_state:00000000 $t
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:837    .text.reset_player_state:00000000 reset_player_state
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:859    .text.reset_player_state:00000010 $d
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:866    .text.mp3_player_fsm:00000000 $t
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:873    .text.mp3_player_fsm:00000000 mp3_player_fsm
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:1071   .text.mp3_player_fsm:00000110 $d
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:1077   .text.mp3_player_fsm:00000128 $t
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:1305   .text.mp3_player_fsm:00000278 $d
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:1386   .bss.has_been_paused:00000000 has_been_paused
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:1358   .bss.currentFileBytesRead:00000000 currentFileBytesRead
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:1351   .bss.currentFileBytes:00000000 currentFileBytes
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:1413   .data.currentFilePosition:00000000 currentFilePosition
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:1400   .bss.mp3FilesCounter:00000000 mp3FilesCounter
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:1340   .bss.buffer_leftover:00000000 $d
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:1344   .bss.buffer_leftover:00000000 buffer_leftover
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:1347   .bss.currentFileBytes:00000000 $d
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:1354   .bss.currentFileBytesRead:00000000 $d
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:1361   .bss.current_ptr:00000000 $d
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:1365   .bss.current_ptr:00000000 current_ptr
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:1368   .bss.decode_result:00000000 $d
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:1372   .bss.decode_result:00000000 decode_result
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:1375   .bss.hMP3Decoder:00000000 $d
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:1379   .bss.hMP3Decoder:00000000 hMP3Decoder
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:1382   .bss.has_been_paused:00000000 $d
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:1389   .bss.in_buf_offs:00000000 $d
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:1393   .bss.in_buf_offs:00000000 in_buf_offs
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:1396   .bss.mp3FilesCounter:00000000 $d
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:1406   .bss.out_buf_offs:00000000 out_buf_offs
ARM GAS  C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s 			page 41


C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:1407   .bss.out_buf_offs:00000000 $d
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:1409   .data.currentFilePosition:00000000 $d
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:1416   .rodata.BSP_init.str1.4:00000000 $d
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:1423   .rodata.fill_input_buffer.str1.4:00000000 $d
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:1429   .rodata.mp3_player_fsm.str1.4:00000000 $d
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:1461   .rodata.mp3_player_play.str1.4:00000000 $d
C:\Users\Patryk\AppData\Local\Temp\ccH9124J.s:1475   .rodata.mp3_player_process_frame.str1.4:00000000 $d

UNDEFINED SYMBOLS
BSP_AUDIO_OUT_Init
xprintf
BSP_AUDIO_OUT_SetAudioFrameSlot
memcpy
f_read
MP3FindSyncWord
MP3GetNextFrameInfo
MP3Decode
__aeabi_i2d
__aeabi_ddiv
MP3InitDecoder
MP3FreeDecoder
BSP_AUDIO_OUT_Play
refresh_screen
BSP_AUDIO_OUT_Pause
strcpy
BSP_AUDIO_OUT_Resume
update_progress_bar
check_touchscreen
BSP_AUDIO_OUT_Stop
touchscreen_loop_init
f_opendir
f_readdir
strstr
f_closedir
malloc
strlen
f_findfirst
f_close
f_open
